t Printers = oService.InstancesOf("Win32_Printer")
    
    else
    
        ListPrinters = kErrorFailure
        
        exit function        
    
    end if
    
    if Err.Number <> kErrorSuccess then         
    
        wscript.echo L_Text_Msg_General11_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description

        ListPrinters = kErrorFailure
            
        exit function
        
    end if    
             
    iTotal = 0
                   
    for each oPrinter in Printers 
    
        iTotal = iTotal + 1                       

        wscript.echo L_Empty_Text
        wscript.echo L_Text_Msg_Printer01_Text & L_Space_Text & strServer
        wscript.echo L_Text_Msg_Printer02_Text & L_Space_Text & oPrinter.DeviceID
        wscript.echo L_Text_Msg_Printer03_Text & L_Space_Text & oPrinter.ShareName
        wscript.echo L_Text_Msg_Printer04_Text & L_Space_Text & oPrinter.DriverName
        wscript.echo L_Text_Msg_Printer05_Text & L_Space_Text & oPrinter.PortName
        wscript.echo L_Text_Msg_Printer06_Text & L_Space_Text & oPrinter.Comment
        wscript.echo L_Text_Msg_Printer07_Text & L_Space_Text & oPrinter.Location
        wscript.echo L_Text_Msg_Printer08_Text & L_Space_Text & oPrinter.SepFile
        wscript.echo L_Text_Msg_Printer09_Text & L_Space_Text & oPrinter.PrintProcessor
        wscript.echo L_Text_Msg_Printer10_Text & L_Space_Text & oPrinter.PrintJobDataType
        wscript.echo L_Text_Msg_Printer11_Text & L_Space_Text & oPrinter.Parameters
        wscript.echo L_Text_Msg_Printer12_Text & L_Space_Text & CSTR(oPrinter.Attributes)
        wscript.echo L_Text_Msg_Printer13_Text & L_Space_Text & CSTR(oPrinter.Priority)
        wscript.echo L_Text_Msg_Printer14_Text & L_Space_Text & CStr(oPrinter.DefaultPriority)

        if CStr(oPrinter.StartTime) <> "" and CStr(oPrinter.UntilTime) <> "" then

            wscript.echo L_Text_Msg_Printer15_Text & L_Space_Text & Mid(Mid(CStr(oPrinter.StartTime), 9, 4), 1, 2) & "h" & Mid(Mid(CStr(oPrinter.StartTime), 9, 4), 3, 2) 
            wscript.echo L_Text_Msg_Printer16_Text & L_Space_Text & Mid(Mid(CStr(oPrinter.UntilTime), 9, 4), 1, 2) & "h" & Mid(Mid(CStr(oPrinter.UntilTime), 9, 4), 3, 2) 

        end if

        wscript.echo L_Text_Msg_Printer17_Text & L_Space_Text & CStr(oPrinter.Status)
        wscript.echo L_Text_Msg_Printer18_Text & L_Space_Text & CStr(oPrinter.Jobs)
        wscript.echo L_Text_Msg_Printer19_Text & L_Space_Text & CStr(oPrinter.AveragePagesPerMinute)
            
        Err.Clear
        
    next

    wscript.echo L_Empty_Text
    wscript.echo L_Text_Msg_General09_Text & L_Space_Text & iTotal 
    
    ListPrinters = kErrorSuccess

end function

'
' Get the default printer
'
function GetDefaultPrinter(strUser, strPassword)

    on error resume next
    
    DebugPrint kDebugTrace, L_Text_Dbg_Msg06_Text

    dim oService
    dim oPrinter
    dim iRetval
    dim oEnum
    
    iRetval = kErrorFailure
    
    '
    ' We connect to the local server
    '                
    if WmiConnect("", kNameSpace, strUser, strPassword, oService) then
        
        set oEnum    = oService.ExecQuery("select DeviceID from Win32_Printer where default=true")
    
    else
    
        SetDefaultPrinter = kErrorFailure
        
        exit function        
    
    end if
    
    if Err.Number = kErrorSuccess then
    
         for each oPrinter in oEnum
         
            wscript.echo L_Text_Msg_General12_Text & L_Space_Text & oPrinter.DeviceID       
                
         next
         
         iRetval = kErrorSuccess
         
    else
    
        wscript.echo L_Text_Msg_General13_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
         
    end if     

    GetDefaultPrinter = iRetval

end function

'
' Set the default printer
'
function SetDefaultPrinter(strPrinter, strUser, strPassword)

    'on error resume next

    DebugPrint kDebugTrace, L_Text_Dbg_Msg07_Text
    
    dim oService
    dim oPrinter
    dim iRetval
    dim uResult
    
    iRetval = kErrorFailure
    
    '
    ' We connect to the local server
    '                
    if WmiConnect("", kNameSpace, strUser, strPassword, oService) then
        
        set oPrinter = oService.Get("Win32_Printer.DeviceID='" & strPrinter & "'")
    
    else
    
        SetDefaultPrinter = kErrorFailure
        
        exit function        
    
    end if
    
    '
    ' Check if Get was successful
    '
    if Err.Number = kErrorSuccess then
        
        '
        ' The Err object indicates whether the WMI provider reached the execution
        ' of the function that sets the default printer. The uResult is the Win32 
        ' error code of the spooler function that sets the default printer
        '
        uResult = oPrinter.SetDefaultPrinter
    
        if Err.Number = kErrorSuccess then

            if uResult = kErrorSuccess then 
            
                wscript.echo L_Text_Msg_General15_Text & L_Space_Text & strPrinter
            
                iRetval = kErrorSuccess
            
            else
            
                wscript.echo L_Text_Msg_General14_Text & L_Space_Text _
                             & L_Text_Error_General03_Text& L_Space_Text & uResult
            
            end if    
            
        else
         
            wscript.echo L_Text_Msg_General14_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                         & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
                         
        end if
        
    else
    
        wscript.echo L_Text_Msg_General14_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
                     
        '
        ' Try getting extended error information
        '              
        call LastError()              
    
    end if
    
    SetDefaultPrinter = iRetval

end function

'
' Debug display helper function
'
sub DebugPrint(uFlags, strString)

    if gDebugFlag = true then

        if uFlags = kDebugTrace then

            wscript.echo L_Debug_Text & L_Space_Text & strString

        end if

        if uFlags = kDebugError then

            if Err <> 0 then

                wscript.echo L_Debug_Text & L_Space_Text & strString & L_Space_Text _
                             & L_Error_Text & L_Space_Text & L_Hex_Text & hex(Err.Number) _
                             & L_Space_Text & Err.Description

            end if

        end if

    end if

end sub

'
' Parse the command line into its components
'
function ParseCommandLine(iAction, strServer, strPrinter, strDriver, strPort, strUser, strPassword)

    on error resume next    

    DebugPrint kDebugTrace, L_Text_Dbg_Msg08_Text

    dim oArgs
    dim iIndex

    iAction = kActionUnknown
    iIndex  = 0

    set oArgs = wscript.Arguments

    while iIndex < oArgs.Count

        select case oArgs(iIndex)

            case "-a"
                iAction = kActionAdd

            case "-ac"
                iAction = kActionAddConn
            
            case "-d"
                iAction = kActionDel

            case "-x"
                iAction = kActionDelAll
            
            case "-l"
                iAction = kActionList
                
            case "-g"
                iAction = kActionGetDefaultPrinter

            case "-t"
                iAction = kActionSetDefaultPrinter

            case "-s"
                iIndex = iIndex + 1
                strServer = RemoveBackslashes(oArgs(iIndex))

            case "-p"
                iIndex = iIndex + 1
                strPrinter = oArgs(iIndex)
            
            case "-m"
                iIndex = iIndex + 1
                strDriver = oArgs(iIndex)
                
            case "-u"
                iIndex = iIndex + 1
                strUser = oArgs(iIndex)
                
            case "-w"
                iIndex = iIndex + 1
                strPassword = oArgs(iIndex)        

            case "-r"
                iIndex = iIndex + 1
                strPort = oArgs(iIndex)
            
            case "-?"
                Usage(true)
                exit function

            case else
                Usage(true)
                exit function

        end select

        iIndex = iIndex + 1

    wend    

    if Err = kErrorSuccess then

        ParseCommandLine = kErrorSuccess

    else
    
        wscript.echo L_Text_Error_General02_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_text & Err.Description
        
        ParseCommandLine = kErrorFailure        

    end if    
    
end  function

'
' Display command usage.
'
sub Usage(bExit)

    wscript.echo L_Help_Help_General01_Text
    wscript.echo L_Help_Help_General02_Text
    wscript.echo L_Help_Help_General03_Text
    wscript.echo L_Help_Help_General04_Text
    wscript.echo L_Help_Help_General05_Text
    wscript.echo L_Help_Help_General06_Text
    wscript.echo L_Help_Help_General07_Text
    wscript.echo L_Help_Help_General08_Text
    wscript.echo L_Help_Help_General09_Text
    wscript.echo L_Help_Help_General10_Text
    wscript.echo L_Help_Help_General11_Text
    wscript.echo L_Help_Help_General12_Text
    wscript.echo L_Help_Help_General13_Text
    wscript.echo L_Help_Help_General14_Text
    wscript.echo L_Help_Help_General15_Text    
    wscript.echo L_Help_Help_General16_Text 
    wscript.echo L_Help_Help_General17_Text
    wscript.echo L_Empty_Text
    wscript.echo L_Help_Help_General18_Text
    wscript.echo L_Help_Help_General19_Text
    wscript.echo L_Help_Help_General20_Text
    wscript.echo L_Help_Help_General21_Text
    wscript.echo L_Help_Help_General22_Text
    wscript.echo L_Help_Help_General23_Text
    wscript.echo L_Help_Help_General24_Text
    wscript.echo L_Help_Help_General25_Text
    wscript.echo L_Help_Help_General26_Text

    if bExit then
    
        wscript.quit(1)
        
    end if

end sub

'
' Determines which program is being used to run this script. 
' Returns true if the script host is cscript.exe
'
function IsHostCscript()

    on error resume next
    
    dim strFullName 
    dim strCommand 
    dim i, j 
    dim bReturn
    
    bReturn = false
    
    strFullName = WScript.FullName
    
    i = InStr(1, strFullName, ".exe", 1)
    
    if i <> 0 then
        
        j = InStrRev(strFullName, "\", i, 1)
        
        if j <> 0 then
            
            strCommand = Mid(strFullName, j+1, i-j-1)
            
            if LCase(strCommand) = "cscript" then
            
                bReturn = true  
            
            end if    
                
        end if
        
    end if
    
    if Err <> 0 then
    
        wscript.echo L_Text_Error_General01_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description 
        
    end if
    
    IsHostCscript = bReturn

end function

'
' Retrieves extended information about the last error that occured 
' during a WBEM operation. The methods that set an SWbemLastError
' object are GetObject, PutInstance, DeleteInstance
'
sub LastError()

    on error resume next

    dim oError

    set oError = CreateObject("WbemScripting.SWbemLastError")
   
    if Err = kErrorSuccess then
   
        wscript.echo L_Operation_Text            & L_Space_Text & oError.Operation
        wscript.echo L_Provider_Text             & L_Space_Text & oError.ProviderName
        wscript.echo L_Description_Text          & L_Space_Text & oError.Description
        wscript.echo L_Text_Error_General03_Text & L_Space_Text & oError.StatusCode
                
    end if                                                             
                                                             
end sub

'
' Connects to the WMI service on a server. oService is returned as a service
' object (SWbemServices)
'
function WmiConnect(strServer, strNameSpace, strUser, strPassword, oService)

    on error resume next

    dim oLocator
    dim bResult
   
    oService = null
   
    bResult  = false
   
    set oLocator = CreateObject("WbemScripting.SWbemLocator")

    if Err = kErrorSuccess then

        set oService = oLocator.ConnectServer(strServer, strNameSpace, strUser, strPassword)

        if Err = kErrorSuccess then

            bResult = true
      
            oService.Security_.impersonationlevel = 3

            '
            ' Required to perform administrative tasks on the spooler service
            '
            oService.Security_.Privileges.AddAsString "SeLoadDriverPrivilege"
          
            Err.Clear
      
        else

            wscript.echo L_Text_Msg_General11_Text & L_Space_Text & L_Error_Text _
                         & L_Space_Text & L_Hex_Text & hex(Err.Number) & L_Space_Text _
                         & Err.Description
            
        end if
   
    else
   
        wscript.echo L_Text_Msg_General10_Text & L_Space_Text & L_Error_Text _
                     & L_Space_Text & L_Hex_Text & hex(Err.Number) & L_Space_Text _
                     & Err.Description
         
    end if                                                         
   
    WmiConnect = bResult
            
end function

'
' Remove leading "\\" from server name
'
function RemoveBackslashes(strServer)

    dim strRet
    
    strRet = strServer
    
    if Left(strServer, 2) = "\\" and Len(strServer) > 2 then 
   
        strRet = Mid(strServer, 3) 
        
    end if   

    RemoveBackslashes = strRet

end function


                                                                                                                                                                                                                              '----------------------------------------------------------------------
'
' Copyright (c) Microsoft Corporation. All rights reserved.
'
' Abstract:
' prnport.vbs - Port script for WMI on Whistler
'     used to add, delete and list ports
'     also for getting and setting the port configuration
'
' Usage:
' prnport [-adlgt?] [-r port] [-s server] [-u user name] [-w password] 
'                   [-o raw|lpr] [-h host address] [-q queue] [-n number]
'                   [-me | -md ] [-i SNMP index] [-y community] [-2e | -2d]"
'
' Examples
' prnport -a -s server -r IP_1.2.3.4 -e 1.2.3.4 -o raw -n 9100
' prnport -d -s server -r c:\temp\foo.prn
' prnport -l -s server
' prnport -g -s server -r IP_1.2.3.4
' prnport -t -s server -r IP_1.2.3.4 -me -y public -i 1 -n 9100
'
'----------------------------------------------------------------------

option explicit

'
' Debugging trace flags, to enable debug output trace message
' change gDebugFlag to true.
'
dim   gDebugFlag
const kDebugTrace = 1
const kDebugError = 2

gDebugFlag = false

'
' Operation action values.
'
const kActionAdd          = 0
const kActionDelete       = 1
const kActionList         = 2
const kActionUnknown      = 3
const kActionGet          = 4
const kActionSet          = 5

const kErrorSuccess       = 0
const KErrorFailure       = 1

const kFlagCreateOrUpdate = 0

const kNameSpace          = "root\cimv2"


'
' Constants for the parameter dictionary
'
const kServerName      = 1
const kPortName        = 2
const kDoubleSpool     = 3
const kPortNumber      = 4
const kPortType        = 5
const kHostAddress     = 6
const kSNMPDeviceIndex = 7
const kCommunityName   = 8
const kSNMP            = 9
const kQueueName       = 10  
const kUserName        = 11
const kPassword        = 12

'
' Generic strings
'
const L_Empty_Text                 = ""
const L_Space_Text                 = " "
const L_Error_Text                 = "Error"
const L_Success_Text               = "Success"
const L_Failed_Text                = "Failed"
const L_Hex_Text                   = "0x"
const L_Printer_Text               = "Printer"
const L_Operation_Text             = "Operation"
const L_Provider_Text              = "Provider"
const L_Description_Text           = "Description"
const L_Debug_Text                 = "Debug:"

'
' General usage messages
'                                 
const L_Help_Help_General01_Text   = "Usage: prnport [-adlgt?] [-r port][-s server][-u user name][-w password]"
const L_Help_Help_General02_Text   = "               [-o raw|lpr][-h host address][-q queue][-n number]"
const L_Help_Help_General03_Text   = "               [-me | -md ][-i SNMP index][-y community][-2e | -2d]"
const L_Help_Help_General04_Text   = "Arguments:"
const L_Help_Help_General05_Text   = "-a     - add a port"
const L_Help_Help_General06_Text   = "-d     - delete the specified port"
const L_Help_Help_General07_Text   = "-g     - get configuration for a TCP port"
const L_Help_Help_General08_Text   = "-h     - IP address of the device"
const L_Help_Help_General09_Text   = "-i     - SNMP index, if SNMP is enabled"
const L_Help_Help_General10_Text   = "-l     - list all TCP ports"
const L_Help_Help_General11_Text   = "-m     - SNMP type. [e] enable, [d] disable"
const L_Help_Help_General12_Text   = "-n     - port number, applies to TCP RAW ports"
const L_Help_Help_General13_Text   = "-o     - port type, raw or lpr"
const L_Help_Help_General14_Text   = "-q     - queue name, applies to TCP LPR ports"
const L_Help_Help_General15_Text   = "-r     - port name"
const L_Help_Help_General16_Text   = "-s     - server name"
const L_Help_Help_General17_Text   = "-t     - set configuration for a TCP port"
const L_Help_Help_General18_Text   = "-u     - user name"
const L_Help_Help_General19_Text   = "-w     - password"
const L_Help_Help_General20_Text   = "-y     - community name, if SNMP is enabled"
const L_Help_Help_General21_Text   = "-2     - double spool, applies to TCP LPR ports. [e] enable, [d] disable"
const L_Help_Help_General22_Text   = "-?     - display command usage"
const L_Help_Help_General23_Text   = "Examples:"
const L_Help_Help_General24_Text   = "prnport -l -s server"
const L_Help_Help_General25_Text   = "prnport -d -s server -r IP_1.2.3.4"
const L_Help_Help_General26_Text   = "prnport -a -s server -r IP_1.2.3.4 -h 1.2.3.4 -o raw -n 9100"
const L_Help_Help_General27_Text   = "prnport -t -s server -r IP_1.2.3.4 -me -y public -i 1 -n 9100"
const L_Help_Help_General28_Text   = "prnport -g -s server -r IP_1.2.3.4"
const L_Help_Help_General29_Text   = "prnport -a -r IP_1.2.3.4 -h 1.2.3.4"
const L_Help_Help_General30_Text   = "Remark:"
const L_Help_Help_General31_Text   = "The last example will try to get the device settings at the specified IP address." 
const L_Help_Help_General32_Text   = "If a device is detected, then a TCP port is added with the preferred settings for that device."

'
' Messages to be displayed if the scripting host is not cscript
'                            
const L_Help_Help_Host01_Text      = "Please run this script using CScript."  
const L_Help_Help_Host02_Text      = "This can be achieved by"
const L_Help_Help_Host03_Text      = "1. Using ""CScript script.vbs arguments"" or" 
const L_Help_Help_Host04_Text      = "2. Changing the default Windows Scripting Host to CScript"
const L_Help_Help_Host05_Text      = "   using ""CScript //H:CScript //S"" and running the script "
const L_Help_Help_Host06_Text      = "   ""script.vbs arguments""."

'
' General error messages
'                                                 
const L_Text_Error_General01_Text  = "The scripting host could not be determined."                
const L_Text_Error_General02_Text  = "Unable to parse command line." 
const L_Text_Error_General03_Text  = "Win32 error code"

'
' Miscellaneous messages
'
const L_Text_Msg_General01_Text    = "Added port"
const L_Text_Msg_General02_Text    = "Unable to delete port"
const L_Text_Msg_General03_Text    = "Unable to get port"
const L_Text_Msg_General04_Text    = "Created/updated port"
const L_Text_Msg_General05_Text    = "Unable to create/update port"
const L_Text_Msg_General06_Text    = "Unable to enumerate ports"
const L_Text_Msg_General07_Text    = "Number of ports enumerated"
const L_Text_Msg_General08_Text    = "Deleted port"
const L_Text_Msg_General09_Text    = "Unable to get SWbemLocator object"
const L_Text_Msg_General10_Text    = "Unable to connect to WMI service"


'
' Port properties
'
const L_Text_Msg_Port01_Text       = "Server name"
const L_Text_Msg_Port02_Text       = "Port name"
const L_Text_Msg_Port03_Text       = "Host address"
const L_Text_Msg_Port04_Text       = "Protocol RAW"
const L_Text_Msg_Port05_Text       = "Protocol LPR"
const L_Text_Msg_Port06_Text       = "Port number"
const L_Text_Msg_Port07_Text       = "Queue"
const L_Text_Msg_Port08_Text       = "Byte Count Enabled"
const L_Text_Msg_Port09_Text       = "Byte Count Disabled"
const L_Text_Msg_Port10_Text       = "SNMP Enabled"
const L_Text_Msg_Port11_Text       = "SNMP Disabled"
const L_Text_Msg_Port12_Text       = "Community"
const L_Text_Msg_Port13_Text       = "Device index"

'
' Debug messages
'
const L_Text_Dbg_Msg01_Text        = "In function DelPort"
const L_Text_Dbg_Msg02_Text        = "In function CreateOrSetPort"
const L_Text_Dbg_Msg03_Text        = "In function ListPorts"
const L_Text_Dbg_Msg04_Text        = "In function GetPort"
const L_Text_Dbg_Msg05_Text        = "In function ParseCommandLine"

main

'
' Main execution starts here
'
sub main

    on error resume next

    dim iAction
    dim iRetval
    dim oParamDict

    '
    ' Abort if the host is not cscript
    '
    if not IsHostCscript() then
   
        call wscript.echo(L_Help_Help_Host01_Text & vbCRLF & L_Help_Help_Host02_Text & vbCRLF & _
                          L_Help_Help_Host03_Text & vbCRLF & L_Help_Help_Host04_Text & vbCRLF & _
                          L_Help_Help_Host05_Text & vbCRLF & L_Help_Help_Host06_Text & vbCRLF)
        
        wscript.quit
   
    end if
    
    set oParamDict = CreateObject("Scripting.Dictionary")

    iRetval = ParseCommandLine(iAction, oParamDict)

    if iRetval = 0 then

        select case iAction

            case kActionAdd
                iRetval = CreateOrSetPort(oParamDict)

            case kActionDelete
                iRetval = DelPort(oParamDict)

            case kActionList
                iRetval = ListPorts(oParamDict)

            case kActionGet
                iRetVal = GetPort(oParamDict)

            case kActionSet
                iRetVal = CreateOrSetPort(oParamDict)

            case else
                Usage(true)
                exit sub

        end select

    end if

end sub

'
' Delete a port
'
function DelPort(oParamDict)

    on error resume next

    DebugPrint kDebugTrace, L_Text_Dbg_Msg01_Text
    DebugPrint kDebugTrace, L_Text_Msg_Port01_Text & L_Space_Text & oParamDict(kServerName)
    DebugPrint kDebugTrace, L_Text_Msg_Port02_Text & L_Space_Text & oParamDict(kPortName)
    
    dim oService
    dim oPort
    dim iResult
    dim strServer
    dim strPort
    dim strUser
    dim strPassword
    
    iResult = kErrorFailure
    
    strServer   = oParamDict(kServerName)
    strPort     = oParamDict(kPortName)
    strUser     = oParamDict(kUserName)
    strPassword = oParamDict(kPassword)
    
    if WmiConnect(strServer, kNameSpace, strUser, strPassword, oService) then

        set oPort = oService.Get("Win32_TCPIPPrinterPort='" & strPort & "'")

    else

        DelPort = kErrorFailure
        
        exit function        
    
    end if
    
    '
    ' Check if Get succeeded
    '
    if Err.Number = kErrorSuccess then 
    
        '
        ' Try deleting the instance
        '
        oPort.Delete_
        
        if Err.Number = kErrorSuccess then
        
            wscript.echo L_Text_Msg_General08_Text & L_Space_Text & strPort
        
        else
        
            wscript.echo L_Text_Msg_General02_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                         & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
        
            '
            ' Try getting extended error information
            '
            call LastError()
        
        end if
        
    else
    
        wscript.echo L_Text_Msg_General02_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
        
        '
        ' Try getting extended error information
        '
        call LastError()
    
    end if
    
    DelPort = iResult

end function

'
' Add or update a port
'
function CreateOrSetPort(oParamDict)

    on error resume next

    dim oPort
    dim oService
    dim iResult
    dim PortType
    dim strServer
    dim strPort
    dim strUser
    dim strPassword
    
    DebugPrint kDebugTrace, L_Text_Dbg_Msg02_Text
    DebugPrint kDebugTrace, L_Text_Msg_Port01_Text & L_Space_Text & oParamDict.Item(kServerName)
    DebugPrint kDebugTrace, L_Text_Msg_Port02_Text & L_Space_Text & oParamDict.Item(kPortName)  
    DebugPrint kDebugTrace, L_Text_Msg_Port06_Text & L_Space_Text & oParamDict.Item(kPortNumber)
    DebugPrint kDebugTrace, L_Text_Msg_Port07_Text & L_Space_Text & oParamDict.Item(kQueueName)
    DebugPrint kDebugTrace, L_Text_Msg_Port13_Text & L_Space_Text & oParamDict.Item(kSNMPDeviceIndex)
    DebugPrint kDebugTrace, L_Text_Msg_Port12_Text & L_Space_Text & oParamDict.Item(kCommunityName)
    DebugPrint kDebugTrace, L_Text_Msg_Port03_Text & L_Space_Text & oParamDict.Item(kHostAddress)
 
    strServer   = oParamDict(kServerName)
    strPort     = oParamDict(kPortName)
    strUser     = oParamDict(kUserName)
    strPassword = oParamDict(kPassword)

    '
    ' If the port exists, then get the settings. Later PutInstance will do an update
    '
    if WmiConnect(strServer, kNameSpace, strUser, strPassword, oService) then

        set oPort = oService.Get("Win32_TCPIPPrinterPort.Name='" & strPort & "'")
        
        '
        ' If get was unsuccessful then spwan a new port instance. Later PutInstance will do a create 
        '    
        if Err.Number <> kErrorSuccess then 

            '
            ' Clear the previous error
            ' 
            Err.Clear
    
            set oPort = oService.Get("Win32_TCPIPPrinterPort").SpawnInstance_

        end if 

    else

        CreateOrSetPort = kErrorFailure
        
        exit function        
    
    end if

    if Err.Number <> kErrorSuccess then
    
        wscript.echo L_Text_Msg_General03_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
        
        CreateOrSetPort = kErrorFailure             
                     
        exit function
    
    end if

    oPort.Name   = oParamDict.Item(kPortName)
    PortType     = oParamDict.Item(kPortType)

    '
    ' Update the port object with the settings corresponding
    ' to the port type of the port to be added
    '
    select case lcase(PortType)

            case "raw"
                 oPort.Protocol      = 1
                 
            case "lpr"
                 oPort.Protocol      = 2
                 
            case else
            
                 '
                 ' PutInstance will attempt to get the configuration of 
                 ' the device based on its IP address. Those settings
                 ' will be used to add a new port
                 '
    end select
    
    oPort.HostAddress   = oParamDict.Item(kHostAddress)
    oPort.PortNumber    = oParamDict.Item(kPortNumber)
    oPort.SNMPEnabled   = oParamDict.Item(kSNMP)
    oPort.SNMPDevIndex  = oParamDict.Item(kSNMPDeviceIndex)
    oPort.SNMPCommunity = oParamDict.Item(kCommunityName)
    oPort.Queue         = oParamDict.Item(kQueueName)
    oPort.ByteCount     = oParamDict.Item(kDoubleSpool)

    '
    ' Try creating or updating the port
    '
    oPort.Put_(kFlagCreateOrUpdate)

    if Err.Number = kErrorSuccess then

        wscript.echo L_Text_Msg_General04_Text & L_Space_Text & oPort.Name

        iResult = kErrorSuccess

    else

        wscript.echo L_Text_Msg_General05_Text & L_Space_Text & oPort.Name & L_Space_Text _
                     & L_Error_Text & L_Space_Text & L_Hex_Text & hex(Err.Number) _ 
                     & L_Space_Text & Err.Description

        '
        ' Try getting extended error information
        '
        call LastError()

        iResult = kErrorFailure

    end if

    CreateOrSetPort = iResult

end function

'
' List ports on a machine.
'
function ListPorts(oParamDict)

    on error resume next

    DebugPrint kDebugTrace, L_Text_Dbg_Msg03_Text
    
    dim Ports
    dim oPort
    dim oService
    dim iRetval
    dim iTotal
    dim strServer
    dim strUser 
    dim strPassword
    
    iResult = kErrorFailure
    
    strServer   = oParamDict(kServerName)
    strUser     = oParamDict(kUserName)
    strPassword = oParamDict(kPassword)

    if WmiConnect(strServer, kNameSpace, strUser, strPassword, oService) then

        set Ports = oService.InstancesOf("Win32_TCPIPPrinterPort")

    else

        ListPorts = kErrorFailure
        
        exit function        
    
    end if
    
    if Err.Number <> kErrorSuccess then         
    
        wscript.echo L_Text_Msg_General06_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description

        ListPrinters = kErrorFailure
            
        exit function
        
    end if    
    
    iTotal = 0          
                  
    for each oPort in Ports

        iTotal = iTotal + 1
            
        wscript.echo L_Empty_Text
        wscript.echo L_Text_Msg_Port01_Text & L_Space_Text & strServer
        wscript.echo L_Text_Msg_Port02_Text & L_Space_Text & oPort.Name
        wscript.echo L_Text_Msg_Port03_Text & L_Space_Text & oPort.HostAddress         

        if oPort.Protocol = 1 then
            
            wscript.echo L_Text_Msg_Port04_Text
            wscript.echo L_Text_Msg_Port06_Text & L_Space_Text & oPort.PortNumber 
                
        else    
            
            wscript.echo L_Text_Msg_Port05_Text
            wscript.echo L_Text_Msg_Port07_Text & L_Space_Text & oPort.Queue
                
            if oPort.ByteCount then
                
                wscript.echo L_Text_Msg_Port08_Text 
                
            else
                
                wscript.echo L_Text_Msg_Port08_Text
                
            end if
                
        end if    
            
        if oPort.SNMPEnabled then
                
            wscript.echo L_Text_Msg_Port10_Text 
            wscript.echo L_Text_Msg_Port12_Text & L_Space_Text & oPort.SNMPCommunity
            wscript.echo L_Text_Msg_Port13_Text & L_Space_Text & oPort.SNMPDevIndex
                
        else
                
            wscript.echo L_Text_Msg_Port11_Text   
                
        end if
            
        Err.Clear
                                        
    next

    wscript.echo L_Empty_Text
    wscript.echo L_Text_Msg_General07_Text & L_Space_Text & iTotal 
    
    ListPorts = kErrorSuccess

end function

'
' Gets the configuration of a port
'
function GetPort(oParamDict)

    on error resume next

    DebugPrint kDebugTrace, L_Text_Dbg_Msg04_Text
    DebugPrint kDebugTrace, L_Text_Msg_Port01_Text & L_Space_Text & oParamDict(kServerName)
    DebugPrint kDebugTrace, L_Text_Msg_Port02_Text & L_Space_Text & oParamDict(kPortName)
    
    dim oService
    dim oPort
    dim iResult
    dim strServer
    dim strPort
    dim strUser 
    dim strPassword
    
    iResult = kErrorFailure
    
    strServer   = oParamDict(kServerName)
    strPort     = oParamDict(kPortName)
    strUser     = oParamDict(kUserName)
    strPassword = oParamDict(kPassword)

    if WmiConnect(strServer, kNameSpace, strUser, strPassword, oService) then

        set oPort = oService.Get("Win32_TCPIPPrinterPort.Name='" & strPort & "'")

    else

        GetPort = kErrorFailure
        
        exit function        
    
    end if

    if Err.Number = kErrorSuccess then 
            
        wscript.echo L_Empty_Text
        wscript.echo L_Text_Msg_Port01_Text & L_Space_Text & strServer
        wscript.echo L_Text_Msg_Port02_Text & L_Space_Text & oPort.Name
        wscript.echo L_Text_Msg_Port03_Text & L_Space_Text & oPort.HostAddress
            
        if oPort.Protocol = 1 then
            
            wscript.echo L_Text_Msg_Port04_Text
            wscript.echo L_Text_Msg_Port06_Text & L_Space_Text & oPort.PortNumber 
                
        else    
            
            wscript.echo L_Text_Msg_Port05_Text 
            wscript.echo L_Text_Msg_Port07_Text & L_Space_Text & oPort.Queue
                
            if oPort.ByteCount then
                
                wscript.echo L_Text_Msg_Port08_Text 
                
            else
                
                wscript.echo L_Text_Msg_Port09_Text   
                
            end if
                
        end if    
            
        if oPort.SNMPEnabled then
                
            wscript.echo L_Text_Msg_Port10_Text 
            wscript.echo L_Text_Msg_Port12_Text & L_Space_Text & oPort.SNMPCommunity
            wscript.echo L_Text_Msg_Port13_Text & L_Space_Text & oPort.SNMPDevIndex
                
        else
                
            wscript.echo L_Text_Msg_Port11_Text   
                
        end if
        
        iResult = kErrorSuccess
            
    else    
        
        wscript.echo L_Text_Msg_General03_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
        
        '
        ' Try getting extended error information
        '
        call LastError()
        
    end if

    GetPort = iResult

end function

'
' Debug display helper function
'
sub DebugPrint(uFlags, strString)

    if gDebugFlag = true then

        if uFlags = kDebugTrace then

            wscript.echo L_Debug_Text & L_Space_Text & strString

        end if

        if uFlags = kDebugError then

            if Err <> 0 then

                wscript.echo L_Debug_Text & L_Space_Text & strString & L_Space_Text _
                             & L_Error_Text & L_Space_Text & L_Hex_Text & hex(Err.Number) _
                             & L_Space_Text & Err.Description

            end if

        end if

    end if

end sub

'
' Parse the command line into its components
'
function ParseCommandLine(iAction, oParamDict)

    on error resume next

    DebugPrint kDebugTrace, L_Text_Dbg_Msg05_Text

    dim oArgs
    dim iIndex

    iAction = kActionUnknown

    set oArgs = Wscript.Arguments

    while iIndex < oArgs.Count

        select case oArgs(iIndex)

            case "-g"
                iAction = kActionGet

            case "-t"
                iAction = kActionSet

            case "-a"
                iAction = kActionAdd

            case "-d"
                iAction = kActionDelete

            case "-l"
                iAction = kActionList

            case "-2e"
                oParamDict.Add kDoubleSpool, true

            case "-2d"
                oParamDict.Add kDoubleSpool, false

            case "-s"
                iIndex = iIndex + 1
                oParamDict.Add kServerName, RemoveBackslashes(oArgs(iIndex))
                
            case "-u"
                iIndex = iIndex + 1
                oParamDict.Add kUserName, oArgs(iIndex)    

            case "-w"
                iIndex = iIndex + 1
                oParamDict.Add kPassword, oArgs(iIndex)
                                    
            case "-n"
                iIndex = iIndex + 1
                oParamDict.Add kPortNumber, oArgs(iIndex)

            case "-r"
                iIndex = iIndex + 1
                oParamDict.Add kPortName, oArgs(iIndex)

            case "-o"
                iIndex = iIndex + 1
                oParamDict.Add kPortType, oArgs(iIndex)

            case "-h"
                iIndex = iIndex + 1
                oParamDict.Add kHostAddress, oArgs(iIndex)

            case "-q"
                iIndex = iIndex + 1
                oParamDict.Add kQueueName, oArgs(iIndex)

            case "-i"
                iIndex = iIndex + 1
                oParamDict.Add kSNMPDeviceIndex, oArgs(iIndex)

            case "-y"
                iIndex = iIndex + 1
                oParamDict.Add kCommunityName, oArgs(iIndex)

            case "-me"
                oParamDict.Add kSNMP, true

            case "-md"
                oParamDict.Add kSNMP, false

            case "-?"
                Usage(True)
                exit function

            case else
                Usage(True)
                exit function

        end select

        iIndex = iIndex + 1

    wend

    if Err = kErrorSuccess then

        ParseCommandLine = kErrorSuccess

    else

        wscript.echo L_Text_Error_General02_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_text & Err.Description


        ParseCommandLine = kErrorFailure

    end if

end  function

'
' Display command usage.
'
sub Usage(bExit)

    wscript.echo L_Help_Help_General01_Text
    wscript.echo L_Help_Help_General02_Text
    wscript.echo L_Help_Help_General03_Text
    wscript.echo L_Help_Help_General04_Text
    wscript.echo L_Help_Help_General05_Text
    wscript.echo L_Help_Help_General06_Text
    wscript.echo L_Help_Help_General07_Text
    wscript.echo L_Help_Help_General08_Text
    wscript.echo L_Help_Help_General09_Text
    wscript.echo L_Help_Help_General10_Text
    wscript.echo L_Help_Help_General11_Text
    wscript.echo L_Help_Help_General12_Text
    wscript.echo L_Help_Help_General13_Text
    wscript.echo L_Help_Help_General14_Text
    wscript.echo L_Help_Help_General15_Text
    wscript.echo L_Help_Help_General16_Text
    wscript.echo L_Help_Help_General17_Text
    wscript.echo L_Help_Help_General18_Text
    wscript.echo L_Help_Help_General19_Text
    wscript.echo L_Help_Help_General20_Text
    wscript.echo L_Help_Help_General21_Text
    wscript.echo L_Help_Help_General22_Text
    wscript.echo L_Empty_Text
    wscript.echo L_Help_Help_General23_Text
    wscript.echo L_Help_Help_General24_Text
    wscript.echo L_Help_Help_General25_Text
    wscript.echo L_Help_Help_General26_Text
    wscript.echo L_Help_Help_General27_Text
    wscript.echo L_Help_Help_General28_Text
    wscript.echo L_Help_Help_General29_Text
    wscript.echo L_Empty_Text
    wscript.echo L_Help_Help_General30_Text
    wscript.echo L_Help_Help_General31_Text
    wscript.echo L_Help_Help_General32_Text

    if bExit then

        wscript.quit(1)

    end if

end sub

'
' Determines which program is being used to run this script. 
' Returns true if the script host is cscript.exe
'
function IsHostCscript()

    on error resume next
    
    dim strFullName 
    dim strCommand 
    dim i, j 
    dim bReturn
    
    bReturn = false
    
    strFullName = WScript.FullName
    
    i = InStr(1, strFullName, ".exe", 1)
    
    if i <> 0 then
        
        j = InStrRev(strFullName, "\", i, 1)
        
        if j <> 0 then
            
            strCommand = Mid(strFullName, j+1, i-j-1)
            
            if LCase(strCommand) = "cscript" then
            
                bReturn = true  
            
            end if    
                
        end if
        
    end if
    
    if Err <> 0 then
    
        wscript.echo L_Text_Error_General01_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description 
        
    end if
    
    IsHostCscript = bReturn

end function

'
' Retrieves extended information about the last error that occured 
' during a WBEM operation. The methods that set an SWbemLastError
' object are GetObject, PutInstance, DeleteInstance
'
sub LastError()

    on error resume next

    dim oError

    set oError = CreateObject("WbemScripting.SWbemLastError")
   
    if Err = kErrorSuccess then
   
        wscript.echo L_Operation_Text            & L_Space_Text & oError.Operation
        wscript.echo L_Provider_Text             & L_Space_Text & oError.ProviderName
        wscript.echo L_Description_Text          & L_Space_Text & oError.Description
        wscript.echo L_Text_Error_General04_Text & L_Space_Text & oError.StatusCode
                
    end if                                                             
                                                             
end sub

'
' Connects to the WMI service on a server. oService is returned as a service
' object (SWbemServices)
'
function WmiConnect(strServer, strNameSpace, strUser, strPassword, oService)

   on error resume next

   dim oLocator
   dim bResult
   
   oService = null
   
   bResult  = false
   
   set oLocator = CreateObject("WbemScripting.SWbemLocator")

   if Err = kErrorSuccess then

      set oService = oLocator.ConnectServer(strServer, strNameSpace, strUser, strPassword)

      if Err = kErrorSuccess then

          bResult = true
      
          oService.Security_.impersonationlevel = 3

          '
          ' Required to perform administrative tasks on the spooler service
          '
          oService.Security_.Privileges.AddAsString "SeLoadDriverPrivilege"
          
          Err.Clear
      
      else

          wscript.echo L_Text_Msg_General10_Text & L_Space_Text & L_Error_Text _
                       & L_Space_Text & L_Hex_Text & hex(Err.Number) & L_Space_Text _
                       & Err.Description
            
      end if
   
   else
   
       wscript.echo L_Text_Msg_General09_Text & L_Space_Text & L_Error_Text _
                    & L_Space_Text & L_Hex_Text & hex(Err.Number) & L_Space_Text _
                    & Err.Description
         
   end if                                                         
   
   WmiConnect = bResult
            
end function

'
' Remove leading "\\" from server name
'
function RemoveBackslashes(strServer)

    dim strRet
    
    strRet = strServer
    
    if Left(strServer, 2) = "\\" and Len(strServer) > 2 then 
   
        strRet = Mid(strServer, 3) 
        
    end if   

    RemoveBackslashes = strRet

end function


                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  '----------------------------------------------------------------------
'
' Copyright (c) Microsoft Corporation. All rights reserved.
'
' Abstract:
' prnqctl.vbs - printer control script for WMI on Whistler
'    used to pause, resume and purge a printer
'    also used to print a test page on a printer
'
' Usage:
' prnqctl [-umex?] [-s server] [-p printer] [-u user name] [-w password]
'
' Examples:
' prnqctl -m -s server -p printer
' prnqctl -x -s server -p printer
' prnqctl -e -b printer
'----------------------------------------------------------------------

option explicit

'
' Debugging trace flags, to enable debug output trace message
' change gDebugFlag to true.
'
const kDebugTrace = 1
const kDebugError = 2
dim   gDebugFlag

gDebugFlag = false

'
' Operation action values.
'
const kActionUnknown    = 0
const kActionPause      = 1
const kActionResume     = 2
const kActionPurge      = 3
const kActionTestPage   = 4

const kErrorSuccess     = 0
const KErrorFailure     = 1

const kNameSpace        = "root\cimv2"

'
' Generic strings
'
const L_Empty_Text                 = ""
const L_Space_Text                 = " "
const L_Error_Text                 = "Error"
const L_Success_Text               = "Success"
const L_Failed_Text                = "Failed"
const L_Hex_Text                   = "0x"
const L_Printer_Text               = "Printer"
const L_Operation_Text             = "Operation"
const L_Provider_Text              = "Provider"
const L_Description_Text           = "Description"
const L_Debug_Text                 = "Debug:"

'
' General usage messages
'                                 
const L_Help_Help_General01_Text   = "Usage: prnqctl [-zmex?] [-s server][-p printer][-u user name][-w password]"
const L_Help_Help_General02_Text   = "Arguments:"
const L_Help_Help_General03_Text   = "-e     - print test page"
const L_Help_Help_General04_Text   = "-m     - resume the printer"
const L_Help_Help_General05_Text   = "-p     - printer name"
const L_Help_Help_General06_Text   = "-s     - server name"
const L_Help_Help_General07_Text   = "-u     - user name"
const L_Help_Help_General08_Text   = "-w     - password"
const L_Help_Help_General09_Text   = "-x     - purge the printer (cancel all jobs)"
const L_Help_Help_General10_Text   = "-z     - pause the printer"
const L_Help_Help_General11_Text   = "-?     - display command usage"
const L_Help_Help_General12_Text   = "Examples:"
const L_Help_Help_General13_Text   = "prnqctl -e -s server -p printer"
const L_Help_Help_General14_Text   = "prnqctl -m -p printer"
const L_Help_Help_General15_Text   = "prnqctl -x -p printer"

'
' Messages to be displayed if the scripting host is not cscript
'                            
const L_Help_Help_Host01_Text      = "Please run this script using CScript."  
const L_Help_Help_Host02_Text      = "This can be achieved by"
const L_Help_Help_Host03_Text      = "1. Using ""CScript script.vbs arguments"" or" 
const L_Help_Help_Host04_Text      = "2. Changing the default Windows Scripting Host to CScript"
const L_Help_Help_Host05_Text      = "   using ""CScript //H:CScript //S"" and running the script "
const L_Help_Help_Host06_Text      = "   ""script.vbs arguments""."

'
' General error messages
'                                                 
const L_Text_Error_General01_Text  = "The scripting host could not be determined."                
const L_Text_Error_General02_Text  = "Unable to parse command line." 
const L_Text_Error_General03_Text  = "Unable to get printer instance."
const L_Text_Error_General04_Text  = "Win32 error code"
const L_Text_Error_General05_Text  = "Unable to get SWbemLocator object"
const L_Text_Error_General06_Text  = "Unable to connect to WMI service"


'
' Action strings
'
const L_Text_Action_General01_Text = "Pause"
const L_Text_Action_General02_Text = "Resume"
const L_Text_Action_General03_Text = "Purge"
const L_Text_Action_General04_Text = "Print Test Page"

'
' Debug messages
'
const L_Text_Dbg_Msg01_Text        = "In function ExecPrinter"
const L_Text_Dbg_Msg02_Text        = "Server name"
const L_Text_Dbg_Msg03_Text        = "Printer name"
const L_Text_Dbg_Msg04_Text        = "In function ParseCommandLine"
                               
main

'
' Main execution starts here
'
sub main

    dim iAction
    dim iRetval
    dim strServer
    dim strPrinter
    dim strUser
    dim strPassword
    
    '
    ' Abort if the host is not cscript
    '
    if not IsHostCscript() then
   
        call wscript.echo(L_Help_Help_Host01_Text & vbCRLF & L_Help_Help_Host02_Text & vbCRLF & _
                          L_Help_Help_Host03_Text & vbCRLF & L_Help_Help_Host04_Text & vbCRLF & _
                          L_Help_Help_Host05_Text & vbCRLF & L_Help_Help_Host06_Text & vbCRLF)
        
        wscript.quit
   
    end if

    '
    ' Get command line parameters
    '
    iRetval = ParseCommandLine(iAction, strServer, strPrinter, strUser, strPassword)

    if iRetval = kErrorSuccess then

        select case iAction

            case kActionPause
                 iRetval = ExecPrinter(strServer, strPrinter, strUser, strPassword, L_Text_Action_General01_Text)

            case kActionResume
                 iRetval = ExecPrinter(strServer, strPrinter, strUser, strPassword, L_Text_Action_General02_Text)

            case kActionPurge
                 iRetval = ExecPrinter(strServer, strPrinter, strUser, strPassword, L_Text_Action_General03_Text)

            case kActionTestPage
                 iRetval = ExecPrinter(strServer, strPrinter, strUser, strPassword, L_Text_Action_General04_Text)

            case kActionUnknown
                 Usage(true)
                 exit sub

            case else
                 Usage(true)
                 exit sub

        end select

    end if

end sub

'
' Pause/Resume/Purge printer and print test page
'
function ExecPrinter(strServer, strPrinter, strUser, strPassword, strCommand)

    on error resume next

    DebugPrint kDebugTrace, L_Text_Dbg_Msg01_Text
    DebugPrint kDebugTrace, L_Text_Dbg_Msg02_Text & L_Space_Text & strServer
    DebugPrint kDebugTrace, L_Text_Dbg_Msg03_Text & L_Space_Text & strPrinter
    
    dim oPrinter
    dim oService
    dim iRetval
    dim uResult
    
    iRetval = kErrorFailure
    
    if WmiConnect(strServer, kNameSpace, strUser, strPassword, oService) then
        
        set oPrinter = oService.Get("Win32_Printer.DeviceID='" & strPrinter & "'")
    
    else
    
        ExecPrinter = kErrorFailure
        
        exit function        
    
    end if
    
    '
    ' Check if getting a printer instance succeeded
    '
    if Err.Number = kErrorSuccess then
    
        select case strCommand
        
            case L_Text_Action_General01_Text
                 uResult = oPrinter.Pause()
                 
            case L_Text_Action_General02_Text
                 uResult = oPrinter.Resume()
                 
            case L_Text_Action_General03_Text
                 uResult = oPrinter.CancelAllJobs()          
                 
            case L_Text_Action_General04_Text
                 uResult = oPrinter.PrintTestPage()  
            
            case else
                 Usage(true)
                 
        end select

        '
        ' Err set by WMI 
        ' 
        if Err.Number = kErrorSuccess then

            '
            ' uResult set by printer methods
            '             
            if uResult = kErrorSuccess then                     
            
                wscript.echo L_Success_Text & L_Space_Text & strCommand & L_Space_Text _
                             & L_Printer_Text & L_Space_Text & strPrinter
        
                iRetval = kErrorSuccess
                
            else
            
                wscript.echo L_Failed_Text & L_Space_Text & strCommand & L_Space_Text _
                             & L_Text_Error_General04_Text & L_Space_Text & uResult 
            
            end if    

        else

            wscript.echo L_Failed_Text & L_Space_Text & strCommand & L_Space_Text & L_Error_Text _
                         & L_Space_Text & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
            
        end if
         
    else      
        
        wscript.echo L_Text_Error_General03_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description
        
        '
        ' Try getting extended error information
        '            
        call LastError()
        
    end if
    
    ExecPrinter = iRetval
    
end function

'
' Debug display helper function
'
sub DebugPrint(uFlags, strString)

    if gDebugFlag = true then

        if uFlags = kDebugTrace then

            wscript.echo L_Debug_Text & L_Space_Text & strString

        end if

        if uFlags = kDebugError then

            if Err <> 0 then

                wscript.echo L_Debug_Text & L_Space_Text & strString & L_Space_Text _
                             & L_Error_Text & L_Space_Text & L_Hex_Text & hex(Err.Number) _
                             & L_Space_Text & Err.Description

            end if

        end if

    end if

end sub

'
' Parse the command line into its components
'
function ParseCommandLine(iAction, strServer, strPrinter, strUser, strPassword)

    on error resume next

    DebugPrint kDebugTrace, L_Text_Dbg_Msg04_Text

    dim oArgs
    dim iIndex

    iAction = kActionUnknown
    iIndex = 0

    set oArgs = wscript.Arguments

    while iIndex < oArgs.Count

        select case oArgs(iIndex)

            case "-z"
                iAction = kActionPause

            case "-m"
                iAction = kActionResume

            case "-x"
                iAction = kActionPurge

            case "-e"
                iAction = kActionTestPage

            case "-p"
                iIndex = iIndex + 1
                strPrinter = oArgs(iIndex)
                
            case "-s"
                iIndex = iIndex + 1
                strServer = RemoveBackslashes(oArgs(iIndex)) 
                  
            case "-y"
                iIndex = iIndex + 1
                strUser = oArgs(iIndex)
                
            case "-w"
                iIndex = iIndex + 1
                strPassword = oArgs(iIndex)           

            case "-?"
                Usage(true)
                exit function

            case else
                Usage(true)
                exit function

        end select

        iIndex = iIndex + 1

    wend

    if Err.Number = kErrorSuccess then

        ParseCommandLine = kErrorSuccess

    else
    
        wscript.echo L_Text_Error_General02_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_text & Err.Description
        
        ParseCommandLine = kErrorFailure
    
    end if
    
end function

'
' Display command usage.
'
sub Usage(bExit)

    wscript.echo L_Help_Help_General01_Text
    wscript.echo L_Empty_Text
    wscript.echo L_Help_Help_General02_Text
    wscript.echo L_Help_Help_General03_Text
    wscript.echo L_Help_Help_General04_Text
    wscript.echo L_Help_Help_General05_Text
    wscript.echo L_Help_Help_General06_Text
    wscript.echo L_Help_Help_General07_Text
    wscript.echo L_Help_Help_General08_Text
    wscript.echo L_Help_Help_General09_Text
    wscript.echo L_Help_Help_General10_Text
    wscript.echo L_Help_Help_General11_Text
    wscript.echo L_Empty_Text
    wscript.echo L_Help_Help_General12_Text
    wscript.echo L_Help_Help_General13_Text
    wscript.echo L_Help_Help_General14_Text
    wscript.echo L_Help_Help_General15_Text

    if bExit then

        wscript.quit(1)

    end if

end sub

'
' Determines which program is being used to run this script. 
' Returns true if the script host is cscript.exe
'
function IsHostCscript()

    on error resume next
    
    dim strFullName 
    dim strCommand 
    dim i, j 
    dim bReturn
    
    bReturn = false
    
    strFullName = WScript.FullName
    
    i = InStr(1, strFullName, ".exe", 1)
    
    if i <> 0 then
        
        j = InStrRev(strFullName, "\", i, 1)
        
        if j <> 0 then
            
            strCommand = Mid(strFullName, j+1, i-j-1)
            
            if LCase(strCommand) = "cscript" then
            
                bReturn = true  
            
            end if    
                
        end if
        
    end if
    
    if Err <> 0 then
    
        wscript.echo L_Text_Error_General01_Text & L_Space_Text & L_Error_Text & L_Space_Text _
                     & L_Hex_Text & hex(Err.Number) & L_Space_Text & Err.Description 
        
    end if
    
    IsHostCscript = bReturn

end function

'
' Retrieves extended information about the last error that occured 
' during a WBEM operation. The methods that set an SWbemLastError
' object are GetObject, PutInstance, DeleteInstance
'
sub LastError()

    on error resume next

    dim oError

    set oError = CreateObject("WbemScripting.SWbemLastError")
   
    if Err = kErrorSuccess then
   
        wscript.echo L_Operation_Text            & L_Space_Text & oError.Operation
        wscript.echo L_Provider_Text             & L_Space_Text & oError.ProviderName
        wscript.echo L_Description_Text          & L_Space_Text & oError.Description
        wscript.echo L_Text_Error_General04_Text & L_Space_Text & oError.StatusCode
                
    end if                                                             
                                                             
end sub

'
' Connects to the WMI service on a server. oService is returned as a service
' object (SWbemServices)
'
function WmiConnect(strServer, strNameSpace, strUser, strPassword, oService)

   on error resume next

   dim oLocator
   dim bResult
   
   oService = null
   
   bResult  = false
   
   set oLocator = CreateObject("WbemScripting.SWbemLocator")

   if Err = kErrorSuccess then

      set oService = oLocator.ConnectServer(strServer, strNameSpace, strUser, strPassword)

      if Err = kErrorSuccess then

          bResult = true
      
          oService.Security_.impersonationlevel = 3

          '
          ' Required to perform administrative tasks on the spooler service
          '
          oService.Security_.Privileges.AddAsString "SeLoadDriverPrivilege"
          
          Err.Clear
      
      else

          wscript.echo L_Text_Msg_General06_Text & L_Space_Text & L_Error_Text _
                       & L_Space_Text & L_Hex_Text & hex(Err.Number) & L_Space_Text _
                       & Err.Description
            
      end if
   
   else
   
       wscript.echo L_Text_Msg_General05_Text & L_Space_Text & L_Error_Text _
                    & L_Space_Text & L_Hex_Text & hex(Err.Number) & L_Space_Text _
                    & Err.Description
         
   end if                                                         
   
   WmiConnect = bResult
            
end function

'
' Remove leading "\\" from server name
'
function RemoveBackslashes(strServer)

    dim strRet
    
    strRet = strServer
    
    if Left(strServer, 2) = "\\" and Len(strServer) > 2 then 
   
        strRet = Mid(strServer, 3) 
        
    end if   

    RemoveBackslashes = strRet

end function 

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            # Copyright (c) 1993-1999 Microsoft Corp.
#
# This file contains the Internet protocols as defined by RFC 1700
# (Assigned Numbers). 
#
# Format:
#
# <protocol name>  <assigned number>  [aliases...]   [#<comment>]

ip       0     IP       # Internet protocol
icmp     1     ICMP     # Internet control message protocol
ggp      3     GGP      # Gateway-gateway protocol
tcp      6     TCP      # Transmission control protocol
egp      8     EGP      # Exterior gateway protocol
pup      12    PUP      # PARC universal packet protocol
udp      17    UDP      # User datagram protocol
hmp      20    HMP      # Host monitoring protocol
xns-idp  22    XNS-IDP  # Xerox NS IDP
rdp      27    RDP      # "reliable datagram" protocol
rvd      66    RVD      # MIT remote virtual disk
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /*++

Copyright (c) 1998-1999 Microsoft Corporation

Module Name:

    PschdCnt.h

Abstract:

    Offset definition file for extensible counter objects and counters

    These "relative" offsets must start at 0 and be multiples of 2 (i.e.
    even numbers). In the Open Procedure, they will be added to the 
    "First Counter" and "First Help" values for the device they belong to, 
    in order to determine the absolute location of the counter and 
    object names and corresponding Explain text in the registry.

    This file is used by the extensible counter DLL code as well as the 
    counter name and Explain text definition file (.INI) file that is used
    by LODCTR to load the names into the registry.

Revision History:

--*/

// PerfMon objects
#define PSCHED_FLOW_OBJ                             0
#define PSCHED_PIPE_OBJ                             2

// Flow counters
#define FLOW_PACKETS_DROPPED                        4
#define FLOW_PACKETS_SCHEDULED                      6
#define FLOW_PACKETS_TRANSMITTED                    8
#define FLOW_AVE_PACKETS_IN_SHAPER                  10
#define FLOW_MAX_PACKETS_IN_SHAPER                  12
#define FLOW_AVE_PACKETS_IN_SEQ                     14
#define FLOW_MAX_PACKETS_IN_SEQ                     16
#define FLOW_BYTES_SCHEDULED                        18
#define FLOW_BYTES_TRANSMITTED                      20
#define FLOW_BYTES_TRANSMITTED_PERSEC               22
#define FLOW_BYTES_SCHEDULED_PERSEC                 24
#define FLOW_PACKETS_TRANSMITTED_PERSEC             26
#define FLOW_PACKETS_SCHEDULED_PERSEC               28
#define FLOW_PACKETS_DROPPED_PERSEC                 30
#define FLOW_NONCONF_PACKETS_SCHEDULED              32
#define FLOW_NONCONF_PACKETS_SCHEDULED_PERSEC       34
#define FLOW_NONCONF_PACKETS_TRANSMITTED            36
#define FLOW_NONCONF_PACKETS_TRANSMITTED_PERSEC     38
#define FLOW_MAX_PACKETS_IN_NETCARD                 40
#define FLOW_AVE_PACKETS_IN_NETCARD                 42

// Pipe counters
#define PIPE_OUT_OF_PACKETS                         44
#define PIPE_FLOWS_OPENED                           46
#define PIPE_FLOWS_CLOSED                           48
#define PIPE_FLOWS_REJECTED                         50
#define PIPE_FLOWS_MODIFIED                         52
#define PIPE_FLOW_MODS_REJECTED                     54
#define PIPE_MAX_SIMULTANEOUS_FLOWS                 56
#define PIPE_NONCONF_PACKETS_SCHEDULED              58
#define PIPE_NONCONF_PACKETS_SCHEDULED_PERSEC       60
#define PIPE_NONCONF_PACKETS_TRANSMITTED            62
#define PIPE_NONCONF_PACKETS_TRANSMITTED_PERSEC     64
#define PIPE_AVE_PACKETS_IN_SHAPER                  66
#define PIPE_MAX_PACKETS_IN_SHAPER                  68
#define PIPE_AVE_PACKETS_IN_SEQ                     70
#define PIPE_MAX_PACKETS_IN_SEQ                     72
#define PIPE_MAX_PACKETS_IN_NETCARD                 74
#define PIPE_AVE_PACKETS_IN_NETCARD                 76

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              MZ                @                                       	!L!This program cannot be run in DOS mode.
$       x	gggfg%:~g%:XgH:"g:{g%:ZgRichg        PE  L q};          7         4     5                     E     d                        7     9  <    >                    B  H  06                                             5                             .text   92     2                    h.rdata     5     5              @  H.data      6     6              @  .edata    7    7              @  @INIT       9      9                 .rsrc      >     >              @  B.reloc    B     B              @  B                                P o l l I n t e r v a l     T r a c e L e v e l     T r a c e M a s k   I o W a i t     S y n c W a i t   Ul$   el S]|@hDdk @Pj6 E|u
     VuxW3j*3Y}}|AAPsu|6 j YUlUVUVjXUVuu@3VVEEEEEEE(E0EDELEPu|MMM MU$M8UlMlh   E  E E6 E4 E6 E H U,E<X MH 6 Vu|(6 _^[p \ D o s D e v i c e s \     P T I L I N K   \ D e v i c e \     P a r a l l e l P o r t     P a r T e c h I n c   U`SV56 Wh EPh EPh EPh EPh EP]=6 EEEEEPj
3SfufE fufE .  EPj
CS  ME]MDfChDdk Pjf36 ;{   K56 3EPSEPSEPSEM]f# EDfChDdk Pj6 {uPEp(6 sK3EPSEPSEPSME}f' MDfGhDdk Pj6 Wu5(6 PEpj s23O3EPuEPuEPu_^[ U   S5 VW3WWEPuEPEPjj EPWWvh0   6 ;t|N6 ;   WWWWEP6 ;   EF0EF4EF8EF<EF@EWFDWEPEPEPjjPxPWWvhT   6 ;u  BN6 ;|3WWWWEP6 ;|!U;NVHtQVHQyy_^[ UQVEP5 uf, F$9 uu5 %BAF,38u5 V#  ^ Vt$F8@@P5 PF8@@P5 ^ Vt$FXN\H3F%P5 f 2F  5 ^ UEVp(EP5 U J8BXNqpAR`Ju5   ^] UQVEP5 E9 u3qB3N8u5 tF`@ME0vu3FtFj j j jj V5 ^ L$D$AD$A5   UQESX(VW=5 EPs$)qPu@$M`8 H%EP96us)qPu@$M`8 H%kEP96uu5 Ma a 25 _^3[ S\$W{t9U-(6 Vw(~L tFPP5 j vTj v\W5 {u^]_[ D$v  KVW<6 u  5wt~ u@@P5 P@@P5 D$8D$03_^ UE8PTIEu@u  MH8MH<MH@MHD3]  SVt$FW=5 tj5P   S6@j@Pj5 @j@Pj 6S6@j@P_^[ Vt$FQW   <   <u6~R=5 uFtj5PFPFPh   6@j@Pc<u_FR<v0<t&v.<v<u&FFPtj5P5 FP
FPfP V=5 h   6@j@PfP _^ QQSUVt$   W=5 h   6@j@Pj5 @j@Pj 6h   6-5 @Ph   6D$@Ph   6@Ph   6D$@PD$@j@Ph   6L$D$2$2L$22u\<t<uT~R u?@h   @PFRh   6@P6<ujZ6@P6<ZuFR@j@PFQxd$ @j@P5 jd$ @PuD$|$r@j@P|$r&j3@PtCrrD$|$r|$FQV_^][YY SV55 Wt$3t$$:tGr_^[ D$L$fSUVt$fT$T$T$3fW=5 f	T$T$T$QT$T$f	T$ff	t$6-5 39^lv@Ptj5 C;^lr;^l   @P3D$ 4P6d$ ~l v@Puj5 D$D$;FlrD$;Fl   @P$D$ 3D$4P6d$ ~l v@Ptj5 D$D$;FlrD$;Flt?@P$D$3D$4P63;~ls@Puj5 G;~lr;~lu20@PfL$$f
\$ fL$$f_^][ SUVt$W=5 3   @P$:D$u@P:D$tj5 E;r_;^][ QQSUVt$W=5 j[8^Q  h   6jPjP3;nps(@P]$<   <tj5 E;npr;np  3  D$P6jPh   V'  3FS D$P6jPh   V]  h   P6-5  D$<v0   :     U6jP   U6j    h   Pj V   6:D$uh   6,[ D$jPj`V[   D$  D$P6jP   UV1   3FP D$P6jPh   VtkD$$ D$P6jPj VtID$% D$D$$t$$6jPj`Vt t$6jPUV     h   jP   U6h   6d$ ~p vN@PD<tY<t=D$3   ujPU6h   6j5 D$D$;FprD$;Fpu      X     S  d$ 3fSL$QL$ QL$Q  PVu        D$:t         <v           D$PD$ PD$P3fPD$,PVu         fD$f;D$t         D$PD$ PD$Pt$0V;u      jfD$f;D$t      Rh   6jPd$ ~p v"@P<tj5 D$D$;FprD$;Fpu"         U6jP2_^][YY U} S5 VuWtu6e    @P5 $:Etj5 E9}r9}t<} tuu6e @P5 $:Etj5 E9}r9}u2} uu6_^[] S\$UVt$W=5 S6-5 j@j@Pj@j
@P@j@PjD$t
uD$t$@@Pjh   6_^][ SUVt$FP3W      NQu<}  :  p  g  <    <N  :F  9n=  9n4  5 h   639npv@P<tj5 G;~pr;~p  h   h   h   h   jV  h   V=5 l$    @P5 tjD$ 9l$ r9l$   @j@Pjuv3@P5 u	jC;r;Y  f~VZ  ~TD$(3d$  5 T$D$vFD$$D$Wt$vd$( v5 u
D$(9l$(r9l$(tDD$ D$ |$;D$r|$ t|$ t$|$(Wv3v5 uG;r;u     j5v5 VyA  D$(jYtD$(=5 h   6339^pv@P<tj5 E;npr;npu   A  h   h   h   h   jV^u     h   V   @P5 tj5 C;r;t*@j@P3@P5 uj5 C;r;u      D$(3D$\$$3+P6@j@Pd$( ~l v@P5 xD$(D$(;FlrD$(;FltS3E+P6@j@Pd$( ~l v@P5 yD$(D$(;FlrD$(;FltE;l$pd   V2  \$(jYtC-5 @j@Ph   639~pv@P^<tj5 G;~pr;~pu   ~ld$  D$  D$ L$$3P6d$( \$v @P5 tj5 D$(9|$(r9|$(   t$6D$ D$$L$ D$@P5 uj5 D$(9|$(r9|$(   t$6\$\$(;s@P5 tj5 C;r;tYt$6@P5 uj5 C;r;t;D$ D$ ;D$h   6@j@P_^][    E   :UQVuu
    ~ u3  fEt
     W~3}A3t3      S@Pxj[Pke ~Q uV@PR$<u   39     V  uuV~tq  wuuVto         P5 ~ uP5 PP5 @PP3' [_^ fQ @PP@PPE}t~39~pv)@Pj$<t<tj5 G;~pr   @PAP7;~p}?   P5 PP5 <  E    ~ uS5 Vt$W39~lv@Ptj5 G;~lr;~lu2  U@P|$l$ffE D$ t 34P65 d$ ~l v@Puj5 D$D$;FlrD$;Flu2  @Pff	E D$ t@34P65 d$ ~l v@Ptj5 D$D$;FlrD$;Flt@P3D$ f	M t@34P65 d$ ~l v@Puj5 D$D$;FlrD$;Fl@Pff	E D$ t@34P65 ]_^[ UQQVu~Qu2~  SW=5 @j@P3;^ts@P<tj5 C;^tr;^tu        e h   6NP$E$EEPEPMEPVMu         E  3SEPEPVdu         fEMv      l  SEPEPV"u      Gf}EMrLf} wD;^ts@P<tj5 C;^tr;^tu         h   6   h   62@j@P_[^ SUVt$FP3W      NQ    <    <n  :f  9n]  9nT  39ntv@P <tj5 G;~tr;~t  5 h   6h   h   h   h   UVO  3   @P5 uj5 E;r;  h   V3@P5 uuj5 E;r;  @j@P@j @Pjuvf~Vu  FT39l$(D$vvd$ v5 D$ tj5 D$9|$r9|$tcD$ t*D$;D$(D$ wt$D$(Uv5 l$ v5 L$$)E;l$(rj5v@j@PV       D$(tD$(5 39ntv@Pd<t
jG;~tr;~tu     h   65 h   h   h   h   UVu   M  l$-5    @PujD$9|$r9|$tQh   Vd$ @PtjD$9|$r9|$t#d$ @PujD$9|$r9|$u      @h   @P5 39|$(5 d$ ~l v@PxjD$D$;FlrD$;Fltk6L$$@h   @P5 39^lv@Pyj5 C;^lr;^lt,6GL$$@h   @P5 G;|$(e-   V2  D$(tD$(=5 @j@P339^tv@P<tj5 E;ntr;ntu   h   6@j@Ph   6nl9\$(\$M  5 d$ v@Ptj5 D$9l$r9l$  @PD$ P6D$L$$D$ L$@Puj5 D$9l$r9l$   @PD$ P6D$ L$$D$@Ptj5 D$9l$r9l$   @PD$ P6D$L$$D$ L$@Puj5 D$9l$r9l$tA@PD$ P6D$ L$$D$D$;D$(\$,   q   f@P<tj5 C;r;>_^][ D$u2 @P$<    QQSVt$f ~ \$w  UW=5 jS\$v-5 $<ujSv$<7  jSj5vv<5  v  	  SD$ u   j4vv         Pvt$D$@Ppt t    F   F   F   3D$  t
Pt$j5vh   v3vu7FHt!HtHHu!j v5 j v5 j vC    r    r3r^ Fj5vjt$
j5vjS_]^[YY  UUMfft} tfAABBM3f! ] US]EPEPEPS   VEP3VVjEPh  u5 }VZEp(W3j`YEFEHEF^PTIE6 6 InitEPEP5 _}fL j u(6 FLEFPEFTEFXEF\j u(6 ^[ Vt$Ft6   vhV`tvu
vhVd2FVj tP5 ^ US]VuWH~HjYtHuNF   5 jh   WVExM5 uf _^[] UQS]Vs,39N}25 S'   F;W~`tL@t@jQQjQP5 Et,5 jwEusME5 E  F|
GFf 25 sDS@S_^[ SVt$Wv,$6   5   	5 uV_^[ U,SV3SSSSh6 6 6 t]   7 W5 6 Clos5 Ep(~   P]5 ;uE(    jW_8_<_@_D&SSEP_5 EPEPjSSjEPE&) uEd uvh8   6 ;tN6 |SSSSEP6 Sv(6 N^^5 ^_Sh6 5 Mu2qY5 ^[ Vt$FpP5 t	   +SW  5   5 _[uV  ^ Vt$F,@`@,  $ F,@`$@+ p @   P   Fp        P5 V,N6 ^ UESWx(EP5 , Ut#V J8O$qBXpA2^W,R`Ju5 tW:_  [] L P T ?   UlEv
     6 V3;u
     MQMQh   XP5 |VVEP5 EPEPjjPEPVVuhT   6 ;tIM6 ;|+VVVVEP6 ;|W}jcuWOf   _jch- u6M5 3^ U8VW3WWEP5 uEPEPjjEPjEPvE&) h4  uEd u 6 ;u  :N6 ;|+WWWWEP6 ;|E;|MN`MNdMNh_^ UEHtEHt+HtHu`EH@` tRj jpDGE@   ;EH@@   t*j jVujVF   yF@t	j jvD^] UEVptY~uSS]W}+      Mx=vjV"+      }xvjV%_[^] USVu3;^  9^8U  3W~A3?        8^QuVEPEPVu^Q       wE   HH   EPEPvDV8;Eu   M9MsuSh#  PQPVGuu   Sh<  uvDV<         P   5 8^QuFQuuF   SuvDV<N   9EE0u   PV   8^Q   uFQ   PV_^[ Vt$vyvDV@^ UV7 5 =6 Closu5    W5 }ig   w      8
v     PRQiEP5 ~ twtwE+F0MN4Mx!=vuuWKEF0EF4   P       W5 _^ QSW3SSSSh6 6 96 t
  c  D$@`@t
 L  D$UVp(nUFPh   FXP5 ;   E @0NA0F@ hDdk F$h  @ S^,6 ;u
    jnY3nVU;}SU(6 ^  F8eO E    ElEp @  EtELEN7 ;tEl7 ;tEpUVz} tfE fETfEERfEVe     9 7 u2FPh0 tP5 Vv})E    E   7   5 FpPVh~*    P5      P      5 D$PD$PvVh	 h	 h	 V} uF8@@P5 PF8@@P5    WVh1    S5 7 5 7 6 Open5 S    W5 jU36 3^]Sh6 5 L$2yY5 _[Y VWt$h 7 7 t$6 7 6 3WVyGr~ u  Nj F81 F@* FD FH,    	 F4N
 %6  h6 5 h7 5 3_^                                                                        j=  \=  N=  :=  &=  =  <  <  <  <  ~=      ;  ";  8;  X;  j;  ;  ;  ;  ;  :  ;  ;  <  &<  4<  P<  h<  |<  <  :  :  :  :  z:  ^:  <:  $:  :   :  ;  9          q};       $   L6  L6  RSDSUkwXFEBnj   ptilink.pdb                 U x  <  s                                                                                                                                                                                                                                                       ^m};    8     	   	   7  7  7  2  
  Z&  (  $-  z&  v/  
  &  8  8  '8  88  N8  c8  w8  8  8            PTILINK.SYS PtiCleanup PtiInitialize PtiIsReadPending PtiPortNameFromPortId PtiQueryDeviceStatus PtiQueryMaxReadSize PtiRead PtiRegisterCallbacks PtiWrite                                                                                                    l9          <  5  <9          =  5                      j=  \=  N=  :=  &=  =  <  <  <  <  ~=      ;  ";  8;  X;  j;  ;  ;  ;  ;  :  ;  ;  <  &<  4<  P<  h<  |<  <  :  :  :  :  z:  ^:  <:  $:  :   :  ;  9      M ExFreePoolWithTag ORtlQueryRegistryValues  memmove @ ExAllocatePoolWithTag RtlAppendUnicodeStringToString  RtlIntegerToUnicodeString RtlInitUnicodeString  `KeWaitForSingleObject IofCallDriver (IoBuildDeviceIoControlRequest KeInitializeEvent IoReleaseCancelSpinLock IoAcquireCancelSpinLock IofCompleteRequest  MmMapLockedPagesSpecifyCache  IIoDeleteDevice  KIoDeleteSymbolicLink  'KeQuerySystemTime CIoCreateUnprotectedSymbolicLink 8IoCreateDevice  KeInsertQueueDpc  -IoCancelIrp 5KeReleaseMutex  !ObfDereferenceObject  KeCancelTimer TKeSetTimer  fIoGetDeviceObjectPointer  KeInitializeSpinLock  KeInitializeTimer KeInitializeDpc KeInitializeMutex ntoskrnl.exe  Y WRITE_PORT_UCHAR  S READ_PORT_UCHAR I KeStallExecutionProcessor V WRITE_PORT_BUFFER_UCHAR P READ_PORT_BUFFER_UCHAR  [ WRITE_PORT_USHORT Z WRITE_PORT_ULONG  M KfLowerIrql N KfRaiseIrql O KfReleaseSpinLock L KfAcquireSpinLock HAL.dll                                                                                                                                             0                 	  H   `>                    4   V S _ V E R S I O N _ I N F O                  (
?                          S t r i n g F i l e I n f o      0 4 0 9 0 4 B 0   X   C o m p a n y N a m e     P a r a l l e l   T e c h n o l o g i e s ,   I n c .    0  F i l e D e s c r i p t i o n     P a r a l l e l   T e c h n o l o g i e s   D i r e c t P a r a l l e l   I O   L i b r a r y   X   F i l e V e r s i o n     1 . 1 0   ( X P C l i e n t . 0 1 0 8 1 7 - 1 1 4 8 )   8   I n t e r n a l N a m e   p t i l i n k . s y s    .  L e g a l C o p y r i g h t   C o p y r i g h t   ( C )   P a r a l l e l   T e c h n o l o g i e s   1 9 9 5 - 1 9 9 7   @   O r i g i n a l F i l e n a m e   p t i l i n k . s y s   j %  P r o d u c t N a m e     M i c r o s o f t    W i n d o w s    O p e r a t i n g   S y s t e m     :   P r o d u c t V e r s i o n   5 . 1 . 2 6 0 0 . 0     D    V a r F i l e I n f o     $    T r a n s l a t i o n     	                                                                                                                   33O4V4]4d4k4r4|4445$5/5:5E5P5_55556K6667=7L7b7777848U8q888888 99C9~999.:A:^:r:::::D;f;;
<*<\<v<<=>y>>>+?}??   |   0E0f00-12K444445B5M5-6R66667E77777Y8e8888%9|99::Y:e:::::<<.<<<<=4====>f>>>?%?       .011X1d1111122A22223333"4X4}44415{55=66677888889d9999::>:g::::::::::; ;S;l;v;;;;;;;;;;</<l<<<<< =?=g=w======
>-><>E>[>m> 0  |   r0111.1:1{11122K2222293D3N3|3333333344 4-42484?4E4O4c4s4}44444444444 5
5555#5(5.5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          '----------------------------------------------------------------------
'    pubprn.vbs - publish printers from a non Windows 2000 server into Windows 2000 DS
'    
'
'     Arguments are:-
'        server - format server
'        DS container - format "LDAP:\\CN=...,DC=...."
'
'
'    Copyright (c) Microsoft Corporation 1997
'   All Rights Reserved
'----------------------------------------------------------------------

'--- Begin Error Strings ---

Dim L_PubprnUsage1_text
Dim L_PubprnUsage2_text
Dim L_PubprnUsage3_text      
Dim L_PubprnUsage4_text      
Dim L_PubprnUsage5_text      
Dim L_PubprnUsage6_text      

Dim L_GetObjectError1_text
Dim L_GetObjectError2_text

Dim L_PublishError1_text
Dim L_PublishError2_text     
Dim L_PublishError3_text
Dim L_PublishSuccess1_text


L_PubprnUsage1_text      =   "Usage: [cscript] pubprn.vbs server ""LDAP://OU=..,DC=..."""
L_PubprnUsage2_text      =   "       server is a Windows server name (e.g.: Server) or UNC printer name (\\Server\Printer)"
L_PubprnUsage3_text      =   "       ""LDAP://CN=...,DC=..."" is the DS path of the target container"
L_PubprnUsage4_text      =   ""
L_PubprnUsage5_text      =   "Example 1: pubprn.vbs MyServer ""LDAP://CN=MyContainer,DC=MyDomain,DC=Company,DC=Com"""
L_PubprnUsage6_text      =   "Example 2: pubprn.vbs \\MyServer\Printer ""LDAP://CN=MyContainer,DC=MyDomain,DC=Company,DC=Com"""

L_GetObjectError1_text   =   "Error: Path "
L_GetObjectError2_text   =   " not found."
L_GetObjectError3_text   =   "Error: Unable to access "

L_PublishError1_text     =   "Error: Pubprn cannot publish printers from "
L_PublishError2_text     =   " because it is running Windows 2000, or later."
L_PublishError3_text     =   "Failed to publish printer "
L_PublishError4_text     =   "Error: "
L_PublishSuccess1_text   =   "Published printer: "

'--- End Error Strings ---


set Args = Wscript.Arguments
if args.count < 2 then
    wscript.echo L_PubprnUsage1_text
    wscript.echo L_PubprnUsage2_text
    wscript.echo L_PubprnUsage3_text
    wscript.echo L_PubprnUsage4_text
    wscript.echo L_PubprnUsage5_text
    wscript.echo L_PubprnUsage6_text
    wscript.quit(1)
end if

ServerName= args(0)
Container = args(1)


on error resume next
Set PQContainer = GetObject(Container)

if err then
    wscript.echo L_GetObjectError1_text & Container & L_GetObjectError2_text
    wscript.quit(1)
end if
on error goto 0



if left(ServerName,1) = "\" then

    PublishPrinter ServerName, ServerName, Container

else

    on error resume next

    Set PrintServer = GetObject("WinNT://" & ServerName & ",computer")

    if err then
        wscript.echo L_GetObjectError3_text & ServerName & ": " & err.Description
        wscript.quit(1)
    end if

    on error goto 0


    For Each Printer In PrintServer
        if Printer.class = "PrintQueue" then PublishPrinter Printer.PrinterPath, ServerName, Container
    Next


end if




sub PublishPrinter(UNC, ServerName, Container)

    
    Set PQ = WScript.CreateObject("OlePrn.DSPrintQueue.1")

    PQ.UNCName = UNC
    PQ.Container = Container

    on error resume next

    PQ.Publish(2)

    if err then
        if err.number = -2147024772 then
            wscript.echo L_PublishError1_text & Chr(34) & ServerName & Chr(34) & L_PublishError2_text
            wscript.quit(1)
        else
            wscript.echo L_PublishError3_text & Chr(34) & UNC & Chr(34) & "."
            wscript.echo L_PublishError4_text & err.Description
        end if
    else
        wscript.echo L_PublishSuccess1_text & PQ.Path
    end if

    Set PQ = nothing

end sub
                                                                                                                                                                                                                                                                                                                                                                                                    INDX( 	 ]            (             u                p Z     /      |Vg4 8pP4Xg4                     e g a 8 0 8 5 2 . f o n      	     p Z     /       
g4 8pP4 
g4                     e g a 8 0 8 5 7 . f o n      	     p Z     /      `'g4 8pP4`'g4                     e g a 8 0 8 6 6 . f o n           p Z     /      ng4 8pP4^pg4        0             e g a 8 0 8 6 9 . f o n           p Z     /       8 8R4`Z#C                        e g a 8 0 w o a . f o n      j     h T     /       8 8h4ZU%C    @     7             	e s t r e . t t f f o w     h T     /       8 8h4C5%C          0             	f r a m d . t t f . t x     h X     /       8 8 8h4R8%C    `     U             f r a m d i t . t t f      h X     /       8 8 8h4 iX%C    P     G             g a  t a m i . t t f @     h X     /       8 80h4-%C    `     ]             g e o r g i a . t t f      p Z     /       8 80h4&/%C    0     &             g e o r g i a b . t t f t t f      p Z     /       8 8h43%C    p     f             g e o r g i a i . t t f t t f      p Z     /       8 8h4 0%C    p     o             g e o r g i a z . t t f t t f _     h V     /       8 8Th4`*%C                      
i m p a c t . t t f f t     h X     /       8 8Th4$g4      l             k a r t i k a . t t f      h T     /       8 8h4\%C          L             	l a t h a . t t f t f      h T     /       8 8 ch4 !&g4       t              	l s a n s . t t f t f      h V     /       8 8 ch4&g4       0              
l s a n s d . t t f f      h X     /       8 8Ph4 @L&g4                     l s a n s d i . t t f      h V     /       8 8qh4&g4                     
l s a n s i . t t f f      h T     /       8 8qh4p$C         |             	l u c o n . t t f t f      h X     /       8 8h4$C                       l _ 1 0 6 4 6 . t t f      h V     /       8 8h4`%C    @     1             
m a n g a l . t t f 6      h X     /       8 8 R4P$C    `      <^             m a r l e t t . t t f      h X     /       8 8h4 %C         h             m i c r o s s . t t f      h V     /       8 8h4 $C    0       "              
m o d e r n . f o n t      h V     /       8 8h4Pc%C          4              
m v b o l i . t t f . <     h R     /       8 8@h4@9%C         y             p a l a . t t f l i . =     h T     /       8  8@h4<%C         T             	p a l a b . t t f t t >     h V     /       8 8ph4n>%C    P     @             
p a l a b i . t t f t ?     h T     /       8 8ph40}A%C                      	p a l a i . t t f i .                     0             
t i m e s i . t t f        p Z     /       8 8 8pg4                   t r e b u c b d . t t f            p Z     /       8 8 8`Bg4       t              t r e b u c b i . t t f            p Z     /       8 8 8Pg4 0                   t r e b u c i t . t t f            p Z     /       8 8 8pg4                    v e r d a n a b . t t f            p Z     /       8 8 8`g4 `     ]             v e r d a n a i . t t f                                                                                                                                   PDSIG |    HGDEF     |GPOS.    <GSUBt   8  	LTSH  p  OS/2<W     VVDMXX/_s    cmapHS     <cvt      fpgm  <  ugasp  	  0   glyf  6  yhdmx'  p  (headT  \   6hheaL     $hmtxz2  L  $loca0  	\  maxpH      nameb8  @  postS    prepj7  `         _<      ?    (s
    	            
cs'
               	   	 l  j    @ R   u   r            f                         MS   @  %  H                              2          2        7        >        K        P        \      	 4 a      
         !-  	   dN  	  
  	    	    	  
  	    	  
  	 	 h  	 
0x  	  B 2001 Microsoft Corporation. All rights reserved.RaaviRegularRaavi RegularRaaviVersion 1.06RaaviRaghunath Joshi (Type Design Director), Apurva JoshiRaavi is an OpenType font for the Indic script- Gurmukhi. It is based on Unicode, contains TrueType outlines and has been designed for use as a UI font.http://www.ncst.ernet.in/~rkjoshi    2 0 0 1   M i c r o s o f t   C o r p o r a t i o n .   A l l   r i g h t s   r e s e r v e d . R a a v i R e g u l a r R a a v i   R e g u l a r R a a v i V e r s i o n   1 . 0 6 R a a v i R a g h u n a t h   J o s h i   ( T y p e   D e s i g n   D i r e c t o r ) ,   A p u r v a   J o s h i R a a v i   i s   a n   O p e n T y p e   f o n t   f o r   t h e   I n d i c   s c r i p t -   G u r m u k h i .   I t   i s   b a s e d   o n   U n i c o d e ,   c o n t a i n s   T r u e T y p e   o u t l i n e s   a n d   h a s   b e e n   d e s i g n e d   f o r   u s e   a s   a   U I   f o n t . h t t p : / / w w w . n c s t . e r n e t . i n / ~ r k j o s h i                                                  	
 !"                          #$%&'                           ()*+                                                                          ,     -.  /01                                          "   <     # @ _ ~   	e




(
0
3
6
9
<
B
H
M
\
^
t    &"%     % [ {   	d




*
2
5
8
<
>
G
K
Y
^
f    &"%c\:  20,*)('&$#   !                .                                              p q r s t u v w x y  { | } ~       5 \ ZvClKm5M!,M			

A
W

%Tj-q6errJqnV_[`xN;'L  E h  !7!Z!!"f"#|#$g$%%|%&&{'*(8(P(h())n)*0*}*++I++++-.F//2/Q/g/}/////000-0C0\0v000001101H1^1x1111122222H2c2y22222333.3D3Z3p33333344-4C4j444455,5N5p555566?6U6z66677<7\777788A8e888899N:T:`:|::::;	;#;9;S;_;k;w;;;;;;;;<J<<<<<  	*"**""	000'(''"('(('' *0000(''"('''(''"('((''(''"('('0002           	 	 
                                                ! ! " " # # $ $ % % & & ' ' ( ( ) ) * * + + , , - - . . / / 0 0 1 1 2 2 3 3 4 4 5 5 6 6 7 7 8 8 9 9 : : ; ; < < = = > > ? ? @ @ A A B B C C D D E E F F G G H H I I J J K K L L M M N N O O P P Q Q R R S S T T U U V V W W X X Y Y Z Z [ [ \ \ ] ] ^ ^ _ _ ` ` a a b b c c d d e e f f g g h h i i j j k k l l m m n n o o p p q q r r s s t t u u v v w w x x y y z z { { | | } } ~ ~                                                                                                                                              ~  }  |  |  {  z  z  y  y  y  w  w  w  v  v  s  r  r  r  r  p  p  p  o  o  n  m  l  l  j  i  i  h  h  h  g  f  f  f  e  c  c  a  a  a  _  _  _  ^  ^  ^  ]  \  [  [  Z  X  X  W@1!##$@F!/#/ #/ / B "Q#x@Rx
  UxB!!K KTBK KSBCX K<RK	P[XYKRK	P[XYY T TCZ[X  K`YPdKSXY2KSXY ss+s+s+++++++  @:QPONMLKJIHGFEDCBA@?>=<;:98765/.-,(&%$#"
	 ,E#F` &`&#HH-,E#F#a &a&#HH-,E#F` a F`&#HH-,E#F#a ` &a a&#HH-,E#F`@a f`&#HH-,E#F#a@` &a@a&#HH-, < <-, E# D# ZQX# D#Y QX# MD#Y &QX# D#Y!!-,  EhD ` EFvhE`D-,
C#Ce
-, 
C#C-, (#p(>(#p(E: -, E%EadPQXED!!Y-, E C`D-,CCe
-, i@a  , b`+d#da\XaY-,E+)#D)z-,Ee,#DE+#D-,KRXED!!Y-,%#  `#-,%#  a#-,% -, ` < <-, a < <-, CC-,!!d#d@ b-,!QXd#d  b @/+Y`-,!QXd#dUb /+Y`-,d#d@ b`#!-,E#E`#E`#E`#vhb -,&&%%E#E &`bch &ae#DD-, E TX@D E@aD!!Y-,E0/E#Ea``iD-,KQX/#p#B!!Y-,KQX %EiSXD!!Y!!Y-,EC `c`iD-,/ED-,E# E`D-,E#E`D-,K#QX 34 3 4 YDD-,CX&EXdf`d `f X!@YaY#XeY)#D#)!!!!!Y-,CX%Ed `f X!@Ya#XeY)#D%% XY%% F%#B<%% F%`#B< X Y%%)%%)%% XY%%CH%%`CH!Y!!!!!!!-,CX%Ed `f X!@Ya#XeY)#D%% XY%% F%#B<%%%% F%`#B< X Y%%)) EeD%%)%% XY%%CH%%%%`CH!Y!!!!!!!-,%  F%#B%%EH!!!!-,% %%CH!!!-,E# E  P X#e#Y#h @PX!@Y#XeY`D-,KS#KQZX E`D!!Y-,KTX E`D!!Y-,KS#KQZX8!!Y-,KTX8!!Y-,-,-,-,-, #KSKQZX#8!!Y-,  I QX@# 84!!Y-,F#F`F# F`ab# #KKpE`  PXaFY`h:-, #Id#SX<!Y-   (P     p  | h  |     w(                                                                                                                                B B   V V 4  0 H 0    iV |   V D   D 0 0  L       X| C|   X ~   8      j  j              P  (          `        `    `  `    `  `  `  (  `  (    t    <    (        <  <  (      F         +    I  d  (      `     ` yd Nd [, P [  B, C, C U    
c a     +    I  dd  U      >            TP        `      `    `    `  `  `  (  `  (  t    <    (    <  (  P  (          `        `    `  `    `  `  `  (  `  (    t    <    (        <  <  (  P  (          `        `    `  `    `  `  `  (  `  (    t    <    (      <  (      % d    j  j                    >  s  s  s  s  s  s    I      I       	 	 	                  	                
 
		 
                  
                 		

 		                  		                 						 	

			        	        					  	

		                 


		


 


		
	
																							        				        																																																																			  


		
	
                 
					
	
	
			 





		

	
	


	
										
		
	

				        	

					
        	





	
	
	

	
								
		
						

	
	


	
										
		
	

						

	
	


	
										
		
	
			  	





                 		
			
		
							 

	


	







	





	
	

	


        


	
		

	
        	



	





	






	

	



	







	





	
	

	




	







	





	
	

	

  	

	
                 


						
	
					


 	












        

			
		

	        



































  
	                	 	







	

	 





        

		


        













  
                	 	










 
        





          
	                
 	
		

         

	          	                
 			         	          
                 							         		          
                 
				

         	
                           


	


	         

                           



	         
                          # 
         #                          & 					         &                           * 


				 

  	       *        	                  !+ 


				!

   	       +        
                   %0 



%!! $ 		       0		          $                *7 !!	*%% ("" 
       7
    	      (""                .< $$"
"".")) ",%%  " "!                 !  <    	       !!!      !         !          ",%%  " "                2A ''% !!%%2%,, %0((##%#%! $##""""""""""" " "!# ##!!          $""   #A    
    ###$$$!##""""""""" " "!# ! ! $##""""""""""" " "!# ##!! ! $##""""""""""" " "!# #!   %0((##%#%                         3!%!!          P   @  ??/10#3#53b   A   #@  ?/999910###.O.u.O.}}    Y<   @//
	     &  //??99///22]2210 ]]#3#####73#7!333#3YVVWWWWVWWVYrrGss  Lf    ) 5 @24	4442222....,	,,,(H$@OH 0 *7   " -3	&	 ?]2?2]/]qq+}]q10qq++]qq]qq]qq]qq#"&54632%'#"&546324&#"32764&#"326B____
%x____E44D!#44#"E44DD44EaiiiNMApiii"8VV88*--*8WW88VV   z  ) 2 @k[2d/V/F*r&6& &k+{++I+Y++*
}***-+&"
"- 4-"&&&
&1 1  ?3??9/99]/2999/999999]} ]] ]]]10]]]]]%'!"'&54%&5476326534&#"67632ztdachd>dyeO5M\'=f\X}tx|zZXW[}NY?C G7(>NJ   A;  @   ?/]9910#;-O.}     )@w     
  /3/3/]]2210]&547 `XRUe]/     +@yiX
		 	
 /3/3/]2210]]]' 7 __r+wAQRF     |@@
		    	    /]999/32]999/32/]9/3299]9/329910!'#'7!5!'737!AeAAeAAAeAA    
   @	 	 //10!#!5!3!
w\w\\{\      @  ?2/]2910%'7#53;s
*  =    //10!5!=        @
   ?/]10!#53  [  *@X     ?3?3/+}10]'[s;I*  iP   j@N)iy&fv&fv)iy6F9I
9I6F ! ??/]10]]]]]]]]]]]]! '&76! 4'&#"3276bnocconb      <  #@ @ ??29/]3910!#'73<T\V    P  P@1YXfv& 		 ??2/210 ]]]]]]]]]!!&5476%654#"'67632W	%sbN^alprs,#*|zat7&_c  Q % o@U%!Yiyk{Y&!$@'H$""`  '$ 	 ?2?9/92/]9/9+10 ]]]]]]#"'532765!#532654'&#"563 +;ojiZ`_ZaTLkW[NPn=:hjFKf~`g>8u]   V  ^(  V@0

//
/ ?/]?9/9//]]9/+}10##!3!33^}cr-|

K=   )(  C@)iy9IYfv 		 ?32?9//10]]]#"'5327654'&#!!!32)~gxWO<hw~s8=EQE?Yl   h<  ' @V9&i&F"V"FVitfE)
z
v)9@  ) O4 $$ ??9/32]/]2]10 ]]]]]]]]]]]]]]]# '&76!3#"6324'&#"3276h}xX*izPJo['LVtONzugpmA=fDerTQ    (  6@ o H 	 	 ??2/329]+]10#&5476767!5!RofM}}V/#.$   P  ' 3 @[k2{2Y2r.c.V."&)(*&$( 5$,	&* H*&0 0 ??9+]/999910 ]]]]]]]]]]]]]]#"'&54767&5476324'&#"64%3276o|o^2viiv4^PD^^DP0JVUJHlzwje6gUMMUg7e@\4--4\v||NIVSG  iP  ' @ZFe#i IYY6ty&fzXz@  )"OIY;%%		 ?32?9/32]]/]]210 ]]]]]]]]]]]]]]!"'532767#"&547632&'&#"326i~iE|m{aMTntT]nVvphJtht=Dpna        @   ?/]10#53#53L     *@	
  


 ?2/]2910#53'7#535|L	%    q  J@%    6 //3]2+}3/+}10%5  hn  Lt   @ 	  //10!5!!5!ii   q  B@!     //233+}+}10'7 O X      ! % ]@; ' zk$'yh
   	
%#
%# ??9/]/]10 ]]]]]]]]#5476767654'&#"#6632#53;(_k$=;'Zn9JCVysyqvS6EM,IfuuZ<;I @dV83w^c    ; D @kuBBVBV@f@f))$)T)v%$%d$i!y!!+!YiyxA- --<A<A<' F4'=?C8#<C
.0-+
 /2229/?9/32/99//]10]]]]]]]]]]]]]#"'&'#"'&5476325332765'&! !27# '&7! &# 32BX\D2<n`Rpuqm ;b1!:ctgb7']f{BP0>*1{C.$ug6   #  @  ///10!!!!uG  Z  ,@X    ?3?3/+}10]7ZssI(K   #  @   ///10!5!!5!q&   $  ?@!    //232+}+}10%'FFUSS  \T    //10!5!\`   # % :@F(%	 	
		%%  //9/9/910 ]]# '&4'&'5676576!3#"33tL:VYYV:LtL8<,:}*wmT]aa]Tl26ZxPE-_ C   ///]10#3|  # & <@($G "
 &  

	 //9/9/910 ]]"!#5327654767&'&54'&##53 3ZU;Ltw+B@;,=7LtL;UZ6b]Tmc.^[DOx[62mS]b   >  j@"hxgw HfEE@Hi!
 /9999/99]+99]]]+10]]#"'&'&#"#54763232673>3H}L=J3H~X+cYYfdpB`-dM&}`     W     #@		 ?/10!#53#53#53W \d  @     //]10!5!\` m  @     //]10!5!     @   ?2/29103#547{     @ ?2/2910'#53?"&       (@ 


  //]10#53!5!#53%##u#   k    //10!5!u  8 z  h@B
 	 	
   	
		
_    
	  /3222/]]+}+}10''7'77PPPP7PPPP g  @
 	
@H/ /_]+/10#"&54632;**;;**;*;;**;;     2 6 @p9.F-V-f-,09/00468#$F(V(f((&v&D&T&d&6&&$0@$,(r(4((&6#

4022#6  ??9/33229/9/9]]]/]9]]]]9]99/3]9]910]]##&#"#"54654'&'#"&54654'&'#536767632!7+S8yob-*9mf4CK2+;iA66PI[F,THXhL&CRsmL_31G=6.FLA*pDD_+:H    2 6 5   a   @`::  P>  /5/5+5     % 6 b   |   @
44P6  /5/55+55    % 6 |   cj    @
**  P;  /55/5+5  n6 }   dV   @	 B>P@ /5+5   86 }   eO   @ B>P@ /55+55     6 |   f   @	 &%P& /5+5     6 5   g(   @	 87P8 /5+5      % 0 ; @D;T8Z3j3y//)9yk(6v6,6*pTd6F1'%=($@"H$*5,,:'%% % : ??9/9/9/222+29]]]99]]10 ]]]]]]]## 47#5367632#&#"!5!!2764'&#!3 uD{ni;-Oys8z2nhdub.`u5_D8?YVF9(|UMmq\W_I[xzvyC9q    6 5   i   @	 @85P8 /5+5      h(  % @v""vK[{ @2H$4D ' 
$$$$  ??99//9999/9]]+9]]10]]##'!"'&54763 6!5!&!"32hss?pwvm?>hWAJJAcq#{[a^X2-2S_3-     @(   o@?&6F

))  ??99//99]9]9]/9/9299]10### '654'#5!!!5!32@8+hQXOnhXsppV     (    N@-i
y
"P_  ??9//]]9/10]]##!#"'&54763!!5!!" 32a4yn@K7nSh0)"-q     ( 3 v@B++1-#!!!135 !- 	H

1//'3  ??9/329/9+9/]9/999/]99/10###"'#"'&'67654'#53327&47632327!+\Z`{]gr1--59S!+vHfy6##00"S4Xhh
M<Be==Z[eX?QhHZznP0':1B      (   * @^+(	"&iy	!

/


% ,%  /#@+H!##)  )	)  
 ?3]99]]?99//]99+/]]9/]93]10 ]]]]]]]]]]!!2&'#"'&54!2654!!#5!&#"32
tY|)Txxbrn\X{B.3]O]me3f7<Fqkc^'     (   E@%]V !			  ??99///9/910]]#!"'&55&547632!!5!5!3 SI5R&]gOxu53n{iE@8iF7   x( $ 0 > @1;/I:-	)'7%=9)@CH)-1++9%  @9 "5)
 

    
 
 -!$ =- ??99//]]9/]99/99+910]]]]]]]]]]]]#!"3!2!#"'&547&54763!5!5!4&#!676%4'&#"36xq6jWZ7~d_exN?>A &IE5>}Vl_qORH*?QP>D+?I[$'
'O5A"&AL$$      (  @@!

/  ??99///]99/10##!#&54632!!5!q;Rh"#`:    ( * 4 < @v1Y1i19Iv%..,+5[5k5{559[k	9p, *>9,'#'#'(5;7"$."/""";+'* 	; ?99?99//]]999]/99//9]9/99]99]]9/10]]]]##&'#"'&54763267654!!53&#5!!327676&#"32u[gV~ >5@RWkB?be]8PW?Sj& |ko?:\DC JvaP+3g'M	4@a<:\6{,9J ;>VP7T   ( & - o@?+!--)'
 /)#$
!'

)#&    ?]?99///9/329/10]]#!"3!!!2363!!"'&547 4%&'#5!!0)9S b_[/+6w6 ,<o*>9<*Tde^-   x(  U@3{lyj &&%  ??9/99]]/]10]]]]## 327#"'&'!5!5!xhN~Rxp':[b:_>1      (  " ~@Q!yY
V6!6IIP` $/?;)  ??9/]]/]]9/910 ]]]]]]]]]]]!#"'&5%5!5!4'&'3276tjgyy.tbJ/.Kbt^UU^    x( ) 3 @wf11w1Y8$ &D'    *0)50'dt*2.""$/o/2&) 2 ??9///]]]99/99]/9/9/]_]9]]99]]10 ]_]]]##"'&54763267654''&76326!5!&'&#"!2xk("hPo6E6B{x$1L@itT!NOCgfP8Mg3(/:@i0

k}(owe)"0     
x( ! ) q@@*&&" +`pT&($			(! ( ??99//9/99]]/99/9/10 ]]#!67632# '&&54632!!5!4#"32xfHgkf?Ah"?L+xNQ)h<V8;dC4]X:{J5     ( , @Myvtf'")) 
&& . *
$	'& $$$),  ??9/]39929//9/9/10 ]]]]]]]]!3#"'&#"!27632#"'&5476325$!5!&}(_X?D\pji]W(?&%/4V4+uF7NaebWo   x( # u@ipv@3Ho## `%!P # 	 ??99//]999///]]9/999+]10]]]##"'&543"3 54'#"54326!5!xuxw]H@Qq'q(i      x(   " w@C		$


y

 Hyp  ??99//]9]32+9]/99//910]##!"'&'67654'#5!!5!3276xF((FBx(GB_pshN:<a==PN"akXL     x(   a@:kZKs$Td
 "   ??99//9//99/10]]]]]]#!!2$32# '&&'&54632!!5!x:owXH2uBO)xyZL6D{J      @(   V@/iy  ??9/32]99/99//10### '67654'#5!!326@33NB@1zaehXHGwTVA    x( ( y@J@P`$
$$  ` *?  &$;)%( 
 ??9/]]/]]q9/9/39/]310]]!'$54'&'&#"&'&547675!5!xfa/z\rEEs_}/afx:e|u6P]ZD''EZ]P6u|h9      @(  Q@,iy  ??9/3]299/9/910### '67654'#5!3267!@33NBIlzae;XhXHGwVA6      (   ( h@<9W)%%! *br%'#'  ' ??99//99]]/9/10 ]]]]#!"67632# '&4763!!5!4#"32u*fHgkf?AhB;;TNQ)7am<V8;dC483(5     (   $ ~@I{\l!9
&!
)

##!####  ??99//]9399329]/9]910]]]]##5!"'&'6767$#5!!5' '76 g~/JBGSWDrJBTh2.5OOcW7p|T4jn@     ( 2 > @wJ9hU%{33y++X+h+3+7/7x" 72@7%  %%/%%0&++)!;)535;5;5/2  ??99//99]9//]9/]9]]]]999]]]10]]]]]]##"'&'&543327654'#"'&5476326767!5!&#"3276"8e,.<n9nRVt]nX Hp{C5'n.Km~Hq`?Is(^8FeOO5@k7%j4pfHFO	     T(  J@(		&	   ??99///299/910]##!#"&54767654!5!!!T5D;R9449YQ-Xh^.rR:LC::Md7*     (   t@@Vfv 


 
  ??99//9999/]99//9/10]##!# 654'"#5!!327eZ+_QdMA7h`3D   @(   K@/td6FV  ??9//10]]]]]#!"'&54763!!5!5!"32@H8X@Um>0}z"0]    ( . 3 @nd3t3d1t1g'w'gw! )+2  @ O  / 50+%,2[)[42&222 0+.  ! ??99//]]]]/9=///]]39999310 ]]]]]]!'67654'&'&'&'&54767&'!5!!6':>`}*z\~?.kOOk.?~\z*}`>:'	
x`Fkk3"=S`hK7?pMMp?7Kh`S="3kkF`x   x(6 Z   `r  @ 4 44P7 /5+]5      ( " _@79-

 $ 
"  ??99//2/9/3210]]]]#!"!!!3"'$547&'&5!!5!5!1}_oT._'2P3IT5   T(6 ^   `e @  P" /5+]5      T(   G@$   ??99///99//9910##!#"&54767654!5!!T5D;R9449YT8h^.rR:LC::Md7}    @(  Y@9dt6FV	$   ??9//9/10]]]]]]]#!"'&54763!!"32!5!@H8XU@m>0"0]     

	 //10#"&54632V=++==++=+==++==   b(  @   ?/10###5!x6      %  Z@vk@'Hi 	0


  ?9/?/]10]+]]]#&'&#"3##!5!47632B=II7[sS4/bzh    %  H@*wfiy 	  ??9//10]]]###53#"#66323ttI=BmRh]/4S  n9  4@iyfv  0

 /]/3]2]10]]! '6732767.2<cp\[yg02A?*"'+$$? 89   f@Bfvfv/?Oiy iy 
 //2]]2]]]2]]2]]10! '6732767! '6732767.2<cp\[yg02..2<cp\[yg02A?*"'+$$?A?*"'+$$?  +e 	 #@iy	    ?/10]]#&'&##532^7mc5D;w f  X@8(Xh+$$
H
/  

/  P`   ?]9/]9]/_]9+10 ]]]]#&'&##532&##532P5Cq;:TNqe.&1M Ia  /@(e
u

K[:    ?/10]]]]#4'&'&53?X;V-uYCBX  dX 6  [@ 
	 @-H	O/?_o
 /]q9/99]+]/910#4'&#"#47&'&536(%;8.4:T4Y_854;^o!*>qY+B#b   ^  5@    /? 0 ?]3]2/+}10]7^~*a\    @(6 @   ` ,#@H ##
P @H   P   /]+5++5  x(6 A   `l  !@H !!P$ /5++5  (6 F   ` @	 P /5+5    x( 1 @X"*&y
f	@CH3&1.3v&/((*."*o$$$$**$1 
	
 ?32229?9///]939//9/3]9]+2]229/33]9910]#&'#"&#6732654'&'#"54326767!5!xf{|o(gc`' o%JOhI|4(3r.3xNrye1w.'ed!DS}<=/'q(49?q  (6 T   `t  ,)H)H)@	
H ))P, /5++++5   -   L@2jz[fvUufUzi[p  	 //]10]]]]]]]]]]#"&546324'&#"326>LL?ILvseSddSevQU   y$   5@)	   ??22/910 ]$5#"&54763254#"32
%%~RQx4!
uN{x!<%}vMJSD%m|   N " m@Cv;Ks4D	 $	/     ?/99//3]]9/22999]]10]]]%&'&'#"543267654&#"'6632 (y[loykk>Ber!\1;bC$E8_cvw|WDZ&   [	 - @_ z y&()p,,,,, )	$@
H /$%,%$$""/'' ?9/]99//9/39/2+29]]999/9]]10 ]]]]]]&'&'#"'&5432$54!#5327654'&#"'63 	A})OCX-Awm jH^I8W<A."#/(W"exn"-^|)GPF$w  P	  ' @S('" " y  + H	p4y%
 ?/3]]9]]]]+]2]]/2]2999910]]]]]]#"'&54767&764'&'326t Ijc}}cjI t{8^n;gCCg0oh[UU[ho0+f9<OlO<:\\   [  -  C@#X  ??9/3299]/10!##"'&'67654&'332673-{},'(9A#Ze"[INW-S*=H45fP'5"    : 9 @\V5t,,e,V,t!e!kzk!  
$#9 0;*
3 9.0#$90$$097&/7 ?/]9///393/2929/]310 ]]]]]]]]]]%#"'&547&54767&5476323"&#"&#"33# 327lNKyGFDh-[#uzL_\jCCLc\]\J2Ek><+G'+|S75j:/;  BG/  U@4yji'X
 rT  ?3?9/]3/2]]10 ]]]]]]]&'6754'&#"&547632G_JMjRt@5WS_c__IKkFRk1u_d  C  3  E@'eu%) 
   ?2?2/322210 ]]]]%# &4'&54632!!327|@\&!Vryoo\RG	?w/kM  C   ) [@3e&u&%%%%)#)  +!#
!  )' ?2?2/32229/210 ]]]]%# &4'&54632!&54763"3!327|@\&]HDE&#1Vryoo\RG	?w,79,?./kM  UD   a@< /?@	H	  ?9/+/]]99//]]3310'654#"&'&547632#53#;96cb6:;"D>`a>D"l44:m'+XX+'m:44h;55; b   #@ 	  ?/10#"'&53327!5!b`\||\`^ a]]a     (  $ \@3C6[ & $	 	 ??99//999/9/9]10]]]#!"3267# 6767&'&#5!!3{di]5=oi918m)$t"5A:M><8ve3<@'|R